{"attachments":{"logoub.svg":{"type":"sha1","value":"dbd140cd97704040c082f51ecab69327a16f0399"}},"cell_type":"markdown","id":"779cd8","input":"<img src=\"logoUB.svg\"  style=\"max-width:20%\">","pos":0,"state":"done","type":"cell"}
{"backend_state":"ready","kernel":"ir","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":76558336},"metadata":{"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"3.6.3"}},"type":"settings"}
{"cell_type":"code","exec_count":0,"id":"4ca3aa","input":"","pos":105,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":0,"id":"9d2d19","input":"","pos":50,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":0,"id":"e37fab","input":"","pos":57,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":0,"id":"ebc97a","input":"","pos":104,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":1,"id":"67609d","input":"## Upload dataset\nheart <- read.csv(file = 'heart.csv')\nhead(heart)\n\nprint('Dimension of the dataset')\ndim(heart)","output":{"0":{"data":{"text/html":"<table>\n<caption>A data.frame: 6 × 14</caption>\n<thead>\n\t<tr><th></th><th scope=col>age</th><th scope=col>sex</th><th scope=col>cp</th><th scope=col>trestbps</th><th scope=col>chol</th><th scope=col>fbs</th><th scope=col>restecg</th><th scope=col>thalach</th><th scope=col>exang</th><th scope=col>oldpeak</th><th scope=col>slope</th><th scope=col>ca</th><th scope=col>thal</th><th scope=col>target</th></tr>\n\t<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><th scope=row>1</th><td>63</td><td>1</td><td>3</td><td>145</td><td>233</td><td>1</td><td>0</td><td>150</td><td>0</td><td>2.3</td><td>0</td><td>0</td><td>1</td><td>1</td></tr>\n\t<tr><th scope=row>2</th><td>37</td><td>1</td><td>2</td><td>130</td><td>250</td><td>0</td><td>1</td><td>187</td><td>0</td><td>3.5</td><td>0</td><td>0</td><td>2</td><td>1</td></tr>\n\t<tr><th scope=row>3</th><td>41</td><td>0</td><td>1</td><td>130</td><td>204</td><td>0</td><td>0</td><td>172</td><td>0</td><td>1.4</td><td>2</td><td>0</td><td>2</td><td>1</td></tr>\n\t<tr><th scope=row>4</th><td>56</td><td>1</td><td>1</td><td>120</td><td>236</td><td>0</td><td>1</td><td>178</td><td>0</td><td>0.8</td><td>2</td><td>0</td><td>2</td><td>1</td></tr>\n\t<tr><th scope=row>5</th><td>57</td><td>0</td><td>0</td><td>120</td><td>354</td><td>0</td><td>1</td><td>163</td><td>1</td><td>0.6</td><td>2</td><td>0</td><td>2</td><td>1</td></tr>\n\t<tr><th scope=row>6</th><td>57</td><td>1</td><td>0</td><td>140</td><td>192</td><td>0</td><td>1</td><td>148</td><td>0</td><td>0.4</td><td>1</td><td>0</td><td>1</td><td>1</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 6 × 14\n\\begin{tabular}{r|llllllllllllll}\n  & age & sex & cp & trestbps & chol & fbs & restecg & thalach & exang & oldpeak & slope & ca & thal & target\\\\\n  & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <dbl> & <int> & <int> & <int> & <int>\\\\\n\\hline\n\t1 & 63 & 1 & 3 & 145 & 233 & 1 & 0 & 150 & 0 & 2.3 & 0 & 0 & 1 & 1\\\\\n\t2 & 37 & 1 & 2 & 130 & 250 & 0 & 1 & 187 & 0 & 3.5 & 0 & 0 & 2 & 1\\\\\n\t3 & 41 & 0 & 1 & 130 & 204 & 0 & 0 & 172 & 0 & 1.4 & 2 & 0 & 2 & 1\\\\\n\t4 & 56 & 1 & 1 & 120 & 236 & 0 & 1 & 178 & 0 & 0.8 & 2 & 0 & 2 & 1\\\\\n\t5 & 57 & 0 & 0 & 120 & 354 & 0 & 1 & 163 & 1 & 0.6 & 2 & 0 & 2 & 1\\\\\n\t6 & 57 & 1 & 0 & 140 & 192 & 0 & 1 & 148 & 0 & 0.4 & 1 & 0 & 1 & 1\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 6 × 14\n\n| <!--/--> | age &lt;int&gt; | sex &lt;int&gt; | cp &lt;int&gt; | trestbps &lt;int&gt; | chol &lt;int&gt; | fbs &lt;int&gt; | restecg &lt;int&gt; | thalach &lt;int&gt; | exang &lt;int&gt; | oldpeak &lt;dbl&gt; | slope &lt;int&gt; | ca &lt;int&gt; | thal &lt;int&gt; | target &lt;int&gt; |\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n| 1 | 63 | 1 | 3 | 145 | 233 | 1 | 0 | 150 | 0 | 2.3 | 0 | 0 | 1 | 1 |\n| 2 | 37 | 1 | 2 | 130 | 250 | 0 | 1 | 187 | 0 | 3.5 | 0 | 0 | 2 | 1 |\n| 3 | 41 | 0 | 1 | 130 | 204 | 0 | 0 | 172 | 0 | 1.4 | 2 | 0 | 2 | 1 |\n| 4 | 56 | 1 | 1 | 120 | 236 | 0 | 1 | 178 | 0 | 0.8 | 2 | 0 | 2 | 1 |\n| 5 | 57 | 0 | 0 | 120 | 354 | 0 | 1 | 163 | 1 | 0.6 | 2 | 0 | 2 | 1 |\n| 6 | 57 | 1 | 0 | 140 | 192 | 0 | 1 | 148 | 0 | 0.4 | 1 | 0 | 1 | 1 |\n\n","text/plain":"  age sex cp trestbps chol fbs restecg thalach exang oldpeak slope ca thal\n1 63  1   3  145      233  1   0       150     0     2.3     0     0  1   \n2 37  1   2  130      250  0   1       187     0     3.5     0     0  2   \n3 41  0   1  130      204  0   0       172     0     1.4     2     0  2   \n4 56  1   1  120      236  0   1       178     0     0.8     2     0  2   \n5 57  0   0  120      354  0   1       163     1     0.6     2     0  2   \n6 57  1   0  140      192  0   1       148     0     0.4     1     0  1   \n  target\n1 1     \n2 1     \n3 1     \n4 1     \n5 1     \n6 1     "},"exec_count":1,"output_type":"execute_result"},"1":{"name":"stdout","output_type":"stream","text":"[1] \"Dimension of the dataset\"\n"},"2":{"data":{"text/html":"<style>\n.list-inline {list-style: none; margin:0; padding: 0}\n.list-inline>li {display: inline-block}\n.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n</style>\n<ol class=list-inline><li>303</li><li>14</li></ol>\n","text/latex":"\\begin{enumerate*}\n\\item 303\n\\item 14\n\\end{enumerate*}\n","text/markdown":"1. 303\n2. 14\n\n\n","text/plain":"[1] 303  14"},"exec_count":1,"output_type":"execute_result"}},"pos":7,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":1,"id":"bffc79","input":"pairs.panels(heart_numeric[1:8],\n            bg = c(\"red\", \"green\")[heart_numeric$sex],\n            pch = 21)","output":{"0":{"ename":"ERROR","evalue":"Error in pairs.panels(heart_numeric[1:8], bg = c(\"red\", \"green\")[heart_numeric$sex], : could not find function \"pairs.panels\"\n","output_type":"error","traceback":["Error in pairs.panels(heart_numeric[1:8], bg = c(\"red\", \"green\")[heart_numeric$sex], : could not find function \"pairs.panels\"\nTraceback:\n"]}},"pos":109,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":10,"id":"a34adc","input":"ggarrange(p1, p2, nrow = 1)#subplot","output":{"0":{"data":{"image/png":"b29a16265ea340ab5f2305a07f35e195af11c767","text/plain":"plot without title"},"exec_count":10,"output_type":"execute_result"}},"pos":29,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":11,"id":"db840e","input":"ggplot(as.data.frame(table(heart_numeric$age,heart_numeric$target)), aes(x = Var1, y = Freq, fill = Var2)) +\n    geom_bar(stat=\"identity\")+\n   labs(y = \"Patient count\",\n         x = \"Age\",\n         fill = \"Target\",\n         title = \"Heart desease vs age\")","output":{"0":{"data":{"image/png":"9909d5e4582e88959207fb4df079fe603758989d","text/plain":"plot without title"},"exec_count":11,"output_type":"execute_result"}},"pos":30,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":12,"id":"ab089a","input":"age_bins <- c(20,30,40,50,60,70,80) #bins for age\nage_cut <- cut(heart_numeric$age, age_bins) #Divide the interval with the bins\n\ntrestbps_bins <- c(80,100,120,140,160,180) #bins for trestbps\ntrestbps_cut <- cut(heart_numeric$trestbps, trestbps_bins) #Divide the interval with the bins\n\nchol_bins <- c(100,150,200,250,300,350,400,450) #bins for trestbps\nchol_cut <- cut(heart_numeric$chol, chol_bins) #Divide the interval with the bins\n\nthalach_bins <- c(60,80,100,120,140,160,180,200,220) #bins for trestbps\nthalach_cut <- cut(heart_numeric$thalach, thalach_bins) #Divide the interval with the bins","pos":31,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":13,"id":"8b4448","input":"p_age <- ggplot(as.data.frame(table(age_cut,heart_numeric$target)), aes(x = age_cut, y = Freq, fill = Var2)) +\n            geom_bar(stat=\"identity\")+\n               labs(y = \"Patient count\",\n                     x = \"age\",\n                     fill = \"Target\",\n                     title = \"Heart desease vs Age\")\np_trestbps <- ggplot(as.data.frame(table(trestbps_cut,heart_numeric$target)), aes(x = trestbps_cut, y = Freq, fill = Var2)) +\n            geom_bar(stat=\"identity\")+\n               labs(y = \"Patient count\",\n                     x = \"trestbps\",\n                     fill = \"Target\",\n                     title = \"Heart desease vs Resting Blood Pressure \")\np_chol <- ggplot(as.data.frame(table(chol_cut,heart_numeric$target)), aes(x = chol_cut, y = Freq, fill = Var2)) +\n            geom_bar(stat=\"identity\")+\n               labs(y = \"Patient count\",\n                     x = \"chol\",\n                     fill = \"Target\",\n                     title = \"Heart desease vs Cholesterol\")\np_thalach <- ggplot(as.data.frame(table(thalach_cut,heart_numeric$target)), aes(x = thalach_cut, y = Freq, fill = Var2)) +\n            geom_bar(stat=\"identity\")+\n               labs(y = \"Patient count\",\n                     x = \"thalach\",\n                     fill = \"Target\",\n                     title = \"Heart desease vs Maximum Heart Rate\")\n\n#subplots\ngrid.arrange(p_age, p_trestbps, p_chol, p_thalach, nrow = 2)","output":{"0":{"data":{"image/png":"cf072c711ce33b029cf764bfb9f446a4c09822a1","text/plain":"plot without title"},"exec_count":13,"output_type":"execute_result"}},"pos":32,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":14,"id":"f39067","input":"library(dplyr)","pos":35,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":15,"id":"be2c9c","input":"barplot(table(heart$cp), ylab = \"Count\",border = NA,\n        main = \"Chest pain type\",col=c(\"#99FFFF\",\"#336699\",\"#66CCFF\",\"#99CCFF\"),names.arg=c(\"Typical angina\", \"Atypical angina\",\"Non-anginal pain\",\"Asymptomatic\"))","output":{"0":{"data":{"image/png":"3e9185cbf10e5d80f82c68e3d5d2c4b527568094","text/plain":"Plot with title “Chest pain type”"},"exec_count":15,"output_type":"execute_result"}},"pos":36,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":16,"id":"2c5287","input":"#Correlation cp with other categorical variables\nchisq.test(heart$cp, heart$sex)\nchisq.test(heart$cp, heart$fbs)\nchisq.test(heart$cp, heart$exang)\nchisq.test(heart$cp, heart$slope)\nchisq.test(heart$cp, heart$thal)\nchisq.test(heart$cp, heart$target)","output":{"0":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$cp and heart$sex\nX-squared = 6.8221, df = 3, p-value = 0.07779\n"},"exec_count":16,"output_type":"execute_result"},"1":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$cp, heart$fbs):\n“Chi-squared approximation may be incorrect”"},"2":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$cp and heart$fbs\nX-squared = 3.8856, df = 3, p-value = 0.2741\n"},"exec_count":16,"output_type":"execute_result"},"3":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$cp and heart$exang\nX-squared = 67.348, df = 3, p-value = 1.577e-14\n"},"exec_count":16,"output_type":"execute_result"},"4":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$cp, heart$slope):\n“Chi-squared approximation may be incorrect”"},"5":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$cp and heart$slope\nX-squared = 27.747, df = 6, p-value = 0.0001048\n"},"exec_count":16,"output_type":"execute_result"},"6":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$cp, heart$thal):\n“Chi-squared approximation may be incorrect”"},"7":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$cp and heart$thal\nX-squared = 41.892, df = 9, p-value = 3.439e-06\n"},"exec_count":16,"output_type":"execute_result"},"8":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$cp and heart$target\nX-squared = 81.686, df = 3, p-value < 2.2e-16\n"},"exec_count":16,"output_type":"execute_result"}},"pos":37,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":17,"id":"56c9a3","input":"barplot(table(heart$fbs), ylab = \"Count\",border = NA,\n        main = \"Number cases fasting blood sugar > 120 mg/dl\",col=c(\"#D55E00\",\"orange\"),names.arg=c(\"True\", \"False\"))","output":{"0":{"data":{"image/png":"22cca505e833296b6bae3471666c1de4d20cacce","text/plain":"Plot with title “Number cases fasting blood sugar > 120 mg/dl”"},"exec_count":17,"output_type":"execute_result"}},"pos":38,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":18,"id":"93527e","input":"#Correlation fbs with other categorical variables\nchisq.test(heart$fbs, heart$sex)\nchisq.test(heart$fbs, heart$cp)\nchisq.test(heart$fbs, heart$exang)\nchisq.test(heart$fbs, heart$slope)\nchisq.test(heart$fbs, heart$thal)\nchisq.test(heart$fbs, heart$target)","output":{"0":{"data":{"text/plain":"\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  heart$fbs and heart$sex\nX-squared = 0.3724, df = 1, p-value = 0.5417\n"},"exec_count":18,"output_type":"execute_result"},"1":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$fbs, heart$cp):\n“Chi-squared approximation may be incorrect”"},"2":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$fbs and heart$cp\nX-squared = 3.8856, df = 3, p-value = 0.2741\n"},"exec_count":18,"output_type":"execute_result"},"3":{"data":{"text/plain":"\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  heart$fbs and heart$exang\nX-squared = 0.075367, df = 1, p-value = 0.7837\n"},"exec_count":18,"output_type":"execute_result"},"4":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$fbs, heart$slope):\n“Chi-squared approximation may be incorrect”"},"5":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$fbs and heart$slope\nX-squared = 3.3734, df = 2, p-value = 0.1851\n"},"exec_count":18,"output_type":"execute_result"},"6":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$fbs, heart$thal):\n“Chi-squared approximation may be incorrect”"},"7":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$fbs and heart$thal\nX-squared = 5.542, df = 3, p-value = 0.1361\n"},"exec_count":18,"output_type":"execute_result"},"8":{"data":{"text/plain":"\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  heart$fbs and heart$target\nX-squared = 0.10627, df = 1, p-value = 0.7444\n"},"exec_count":18,"output_type":"execute_result"}},"pos":39,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":19,"id":"71c7c8","input":"barplot(table(heart$exang), xlab = \"Exang (0 = no; 1 = yes)\", ylab = \"Count\",border = NA,\n        main = \"Exercise induced angina\",col=c(\"#CC79A7\",\"gray\"),names.arg=c(\"No\", \"Yes\"))","output":{"0":{"data":{"image/png":"cafe71f69b83d6b6d3a09d500a018735e157d0a0","text/plain":"Plot with title “Exercise induced angina”"},"exec_count":19,"output_type":"execute_result"}},"pos":40,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":2,"id":"83ede3","input":"summary(heart)","output":{"0":{"data":{"text/plain":"      age             sex               cp           trestbps    \n Min.   :29.00   Min.   :0.0000   Min.   :0.000   Min.   : 94.0  \n 1st Qu.:47.50   1st Qu.:0.0000   1st Qu.:0.000   1st Qu.:120.0  \n Median :55.00   Median :1.0000   Median :1.000   Median :130.0  \n Mean   :54.37   Mean   :0.6832   Mean   :0.967   Mean   :131.6  \n 3rd Qu.:61.00   3rd Qu.:1.0000   3rd Qu.:2.000   3rd Qu.:140.0  \n Max.   :77.00   Max.   :1.0000   Max.   :3.000   Max.   :200.0  \n      chol            fbs            restecg          thalach     \n Min.   :126.0   Min.   :0.0000   Min.   :0.0000   Min.   : 71.0  \n 1st Qu.:211.0   1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:133.5  \n Median :240.0   Median :0.0000   Median :1.0000   Median :153.0  \n Mean   :246.3   Mean   :0.1485   Mean   :0.5281   Mean   :149.6  \n 3rd Qu.:274.5   3rd Qu.:0.0000   3rd Qu.:1.0000   3rd Qu.:166.0  \n Max.   :564.0   Max.   :1.0000   Max.   :2.0000   Max.   :202.0  \n     exang           oldpeak         slope             ca        \n Min.   :0.0000   Min.   :0.00   Min.   :0.000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.00   1st Qu.:1.000   1st Qu.:0.0000  \n Median :0.0000   Median :0.80   Median :1.000   Median :0.0000  \n Mean   :0.3267   Mean   :1.04   Mean   :1.399   Mean   :0.7294  \n 3rd Qu.:1.0000   3rd Qu.:1.60   3rd Qu.:2.000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :6.20   Max.   :2.000   Max.   :4.0000  \n      thal           target      \n Min.   :0.000   Min.   :0.0000  \n 1st Qu.:2.000   1st Qu.:0.0000  \n Median :2.000   Median :1.0000  \n Mean   :2.314   Mean   :0.5446  \n 3rd Qu.:3.000   3rd Qu.:1.0000  \n Max.   :3.000   Max.   :1.0000  "},"exec_count":2,"output_type":"execute_result"}},"pos":12,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":20,"id":"dc49d8","input":"#Correlation exang with other categorical variables\nchisq.test(heart$exang, heart$sex)\nchisq.test(heart$exang, heart$fbs)\nchisq.test(heart$exang, heart$cp)\nchisq.test(heart$exang, heart$slope)\nchisq.test(heart$exang, heart$thal)\nchisq.test(heart$exang, heart$target)","output":{"0":{"data":{"text/plain":"\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  heart$exang and heart$sex\nX-squared = 5.4489, df = 1, p-value = 0.01958\n"},"exec_count":20,"output_type":"execute_result"},"1":{"data":{"text/plain":"\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  heart$exang and heart$fbs\nX-squared = 0.075367, df = 1, p-value = 0.7837\n"},"exec_count":20,"output_type":"execute_result"},"2":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$exang and heart$cp\nX-squared = 67.348, df = 3, p-value = 1.577e-14\n"},"exec_count":20,"output_type":"execute_result"},"3":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$exang and heart$slope\nX-squared = 25.131, df = 2, p-value = 3.49e-06\n"},"exec_count":20,"output_type":"execute_result"},"4":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$exang, heart$thal):\n“Chi-squared approximation may be incorrect”"},"5":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$exang and heart$thal\nX-squared = 32.959, df = 3, p-value = 3.285e-07\n"},"exec_count":20,"output_type":"execute_result"},"6":{"data":{"text/plain":"\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  heart$exang and heart$target\nX-squared = 55.945, df = 1, p-value = 7.454e-14\n"},"exec_count":20,"output_type":"execute_result"}},"pos":41,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":21,"id":"609e16","input":"barplot(table(heart$slope),ylab = \"Count\",border = NA,\n        main = \"Slope of the peak exercise ST segment\",col=c(\"#56B4E9\",\"#009999\", \"#0000FF\"), names.arg=c(\"Upsloping\", \"Flat\",\"Downsloping\"))","output":{"0":{"data":{"image/png":"a1659d15330a3472a89614363eba511d417c8350","text/plain":"Plot with title “Slope of the peak exercise ST segment”"},"exec_count":21,"output_type":"execute_result"}},"pos":42,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":22,"id":"5907fe","input":"#Correlation slope with other categorical variables\nchisq.test(heart$slope, heart$sex)\nchisq.test(heart$slope, heart$fbs)\nchisq.test(heart$slope, heart$exang)\nchisq.test(heart$slope, heart$cp)\nchisq.test(heart$slope, heart$thal)\nchisq.test(heart$slope, heart$target)","output":{"0":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$slope and heart$sex\nX-squared = 0.64832, df = 2, p-value = 0.7231\n"},"exec_count":22,"output_type":"execute_result"},"1":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$slope, heart$fbs):\n“Chi-squared approximation may be incorrect”"},"2":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$slope and heart$fbs\nX-squared = 3.3734, df = 2, p-value = 0.1851\n"},"exec_count":22,"output_type":"execute_result"},"3":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$slope and heart$exang\nX-squared = 25.131, df = 2, p-value = 3.49e-06\n"},"exec_count":22,"output_type":"execute_result"},"4":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$slope, heart$cp):\n“Chi-squared approximation may be incorrect”"},"5":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$slope and heart$cp\nX-squared = 27.747, df = 6, p-value = 0.0001048\n"},"exec_count":22,"output_type":"execute_result"},"6":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$slope, heart$thal):\n“Chi-squared approximation may be incorrect”"},"7":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$slope and heart$thal\nX-squared = 35.283, df = 6, p-value = 3.798e-06\n"},"exec_count":22,"output_type":"execute_result"},"8":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$slope and heart$target\nX-squared = 47.507, df = 2, p-value = 4.831e-11\n"},"exec_count":22,"output_type":"execute_result"}},"pos":43,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":23,"id":"75e912","input":"barplot(table(heart$thal), ylab = \"Count\",border = NA,\n        main = \"Thal\",col=c(\"#999999\",\"green\",\"orange\"), names.arg=c(\"0\", \"Normal\",\"Fixed defect\",\"Reversable defect\"))","output":{"0":{"data":{"image/png":"7d5e781586de7ebc9e2362107256115c7f65606e","text/plain":"Plot with title “Thal”"},"exec_count":23,"output_type":"execute_result"}},"pos":44,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":24,"id":"1f04c4","input":"#Correlation cp with other categorical variables\nchisq.test(heart$thal, heart$sex)\nchisq.test(heart$thal, heart$fbs)\nchisq.test(heart$thal, heart$exang)\nchisq.test(heart$thal, heart$slope)\nchisq.test(heart$thal, heart$cp)\nchisq.test(heart$thal, heart$target)","output":{"0":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$thal, heart$sex):\n“Chi-squared approximation may be incorrect”"},"1":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$thal and heart$sex\nX-squared = 44.626, df = 3, p-value = 1.111e-09\n"},"exec_count":24,"output_type":"execute_result"},"10":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$thal, heart$target):\n“Chi-squared approximation may be incorrect”"},"11":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$thal and heart$target\nX-squared = 85.304, df = 3, p-value < 2.2e-16\n"},"exec_count":24,"output_type":"execute_result"},"2":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$thal, heart$fbs):\n“Chi-squared approximation may be incorrect”"},"3":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$thal and heart$fbs\nX-squared = 5.542, df = 3, p-value = 0.1361\n"},"exec_count":24,"output_type":"execute_result"},"4":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$thal, heart$exang):\n“Chi-squared approximation may be incorrect”"},"5":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$thal and heart$exang\nX-squared = 32.959, df = 3, p-value = 3.285e-07\n"},"exec_count":24,"output_type":"execute_result"},"6":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$thal, heart$slope):\n“Chi-squared approximation may be incorrect”"},"7":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$thal and heart$slope\nX-squared = 35.283, df = 6, p-value = 3.798e-06\n"},"exec_count":24,"output_type":"execute_result"},"8":{"name":"stderr","output_type":"stream","text":"Warning message in chisq.test(heart$thal, heart$cp):\n“Chi-squared approximation may be incorrect”"},"9":{"data":{"text/plain":"\n\tPearson's Chi-squared test\n\ndata:  heart$thal and heart$cp\nX-squared = 41.892, df = 9, p-value = 3.439e-06\n"},"exec_count":24,"output_type":"execute_result"}},"pos":45,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":25,"id":"ac5b66","input":"heart%>% count(target)\n(tableTargetSex <- heart%>% count(target,sex))\nstr(tableTargetSex)\n(TargetSex<-as.data.frame(tableTargetSex))","output":{"0":{"data":{"text/html":"<table>\n<caption>A tibble: 2 × 2</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>138</td></tr>\n\t<tr><td>1</td><td>165</td></tr>\n</tbody>\n</table>\n","text/latex":"A tibble: 2 × 2\n\\begin{tabular}{ll}\n target & n\\\\\n <int> & <int>\\\\\n\\hline\n\t 0 & 138\\\\\n\t 1 & 165\\\\\n\\end{tabular}\n","text/markdown":"\nA tibble: 2 × 2\n\n| target &lt;int&gt; | n &lt;int&gt; |\n|---|---|\n| 0 | 138 |\n| 1 | 165 |\n\n","text/plain":"  target n  \n1 0      138\n2 1      165"},"exec_count":25,"output_type":"execute_result"},"1":{"data":{"text/html":"<table>\n<caption>A tibble: 4 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>sex</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td> 24</td></tr>\n\t<tr><td>0</td><td>1</td><td>114</td></tr>\n\t<tr><td>1</td><td>0</td><td> 72</td></tr>\n\t<tr><td>1</td><td>1</td><td> 93</td></tr>\n</tbody>\n</table>\n","text/latex":"A tibble: 4 × 3\n\\begin{tabular}{lll}\n target & sex & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 &  24\\\\\n\t 0 & 1 & 114\\\\\n\t 1 & 0 &  72\\\\\n\t 1 & 1 &  93\\\\\n\\end{tabular}\n","text/markdown":"\nA tibble: 4 × 3\n\n| target &lt;int&gt; | sex &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 |  24 |\n| 0 | 1 | 114 |\n| 1 | 0 |  72 |\n| 1 | 1 |  93 |\n\n","text/plain":"  target sex n  \n1 0      0    24\n2 0      1   114\n3 1      0    72\n4 1      1    93"},"exec_count":25,"output_type":"execute_result"},"2":{"name":"stdout","output_type":"stream","text":"tibble [4 × 3] (S3: tbl_df/tbl/data.frame)\n $ target: int [1:4] 0 0 1 1\n $ sex   : int [1:4] 0 1 0 1\n $ n     : int [1:4] 24 114 72 93\n"},"3":{"data":{"text/html":"<table>\n<caption>A data.frame: 4 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>sex</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td> 24</td></tr>\n\t<tr><td>0</td><td>1</td><td>114</td></tr>\n\t<tr><td>1</td><td>0</td><td> 72</td></tr>\n\t<tr><td>1</td><td>1</td><td> 93</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 4 × 3\n\\begin{tabular}{lll}\n target & sex & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 &  24\\\\\n\t 0 & 1 & 114\\\\\n\t 1 & 0 &  72\\\\\n\t 1 & 1 &  93\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 4 × 3\n\n| target &lt;int&gt; | sex &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 |  24 |\n| 0 | 1 | 114 |\n| 1 | 0 |  72 |\n| 1 | 1 |  93 |\n\n","text/plain":"  target sex n  \n1 0      0    24\n2 0      1   114\n3 1      0    72\n4 1      1    93"},"exec_count":25,"output_type":"execute_result"}},"pos":48,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":26,"id":"d3ba3f","input":"barplot(table(heart$target), ylab = \"Count\",border = NA,\n        main = \"Number cases heart disease\",col=c(\"#CCFFFF\",\"#FF6666\"),names.arg=c(\"No disease\", \"Disease\"))","output":{"0":{"data":{"image/png":"54573b0bb2d7f4f39c55fefd263ee0983b25bf1b","text/plain":"Plot with title “Number cases heart disease”"},"exec_count":26,"output_type":"execute_result"}},"pos":49,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":27,"id":"8eca72","input":"Nodisease <- sum(heart$target == 0)\nDisease <- sum(heart$target == 1)\nTotaltarget <- length(heart$target)\nPercNodisease <- round(Nodisease*100/Totaltarget)\nPercdisease <- round(Disease*100/Totaltarget)\npaste(\"Percentage of patients that do not have heart disease: \",PercNodisease,\"%\")\npaste(\"Percentage of patients that have heart disease: \",Percdisease,\"%\")","output":{"0":{"data":{"text/html":"<span style=white-space:pre-wrap>'Percentage of patients that do not have heart disease:  46 %'</span>","text/latex":"'Percentage of patients that do not have heart disease:  46 \\%'","text/markdown":"<span style=white-space:pre-wrap>'Percentage of patients that do not have heart disease:  46 %'</span>","text/plain":"[1] \"Percentage of patients that do not have heart disease:  46 %\""},"exec_count":27,"output_type":"execute_result"},"1":{"data":{"text/html":"<span style=white-space:pre-wrap>'Percentage of patients that have heart disease:  54 %'</span>","text/latex":"'Percentage of patients that have heart disease:  54 \\%'","text/markdown":"<span style=white-space:pre-wrap>'Percentage of patients that have heart disease:  54 %'</span>","text/plain":"[1] \"Percentage of patients that have heart disease:  54 %\""},"exec_count":27,"output_type":"execute_result"}},"pos":51,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":28,"id":"be0229","input":"(tableheartsex <- heart%>% count(sex))\n(Sex<-as.data.frame(tableheartsex))\nggplot(Sex, aes(x=factor(sex), y=n)) + \n  geom_bar(stat = \"identity\", position=\"dodge\")+scale_fill_hue(c = 40) +\n  theme(legend.position=\"none\")+ geom_col(fill = \"#E69F00\", \"#56B4E9\")","output":{"0":{"data":{"text/html":"<table>\n<caption>A tibble: 2 × 2</caption>\n<thead>\n\t<tr><th scope=col>sex</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td> 96</td></tr>\n\t<tr><td>1</td><td>207</td></tr>\n</tbody>\n</table>\n","text/latex":"A tibble: 2 × 2\n\\begin{tabular}{ll}\n sex & n\\\\\n <int> & <int>\\\\\n\\hline\n\t 0 &  96\\\\\n\t 1 & 207\\\\\n\\end{tabular}\n","text/markdown":"\nA tibble: 2 × 2\n\n| sex &lt;int&gt; | n &lt;int&gt; |\n|---|---|\n| 0 |  96 |\n| 1 | 207 |\n\n","text/plain":"  sex n  \n1 0    96\n2 1   207"},"exec_count":28,"output_type":"execute_result"},"1":{"data":{"text/html":"<table>\n<caption>A data.frame: 2 × 2</caption>\n<thead>\n\t<tr><th scope=col>sex</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td> 96</td></tr>\n\t<tr><td>1</td><td>207</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 2 × 2\n\\begin{tabular}{ll}\n sex & n\\\\\n <int> & <int>\\\\\n\\hline\n\t 0 &  96\\\\\n\t 1 & 207\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 2 × 2\n\n| sex &lt;int&gt; | n &lt;int&gt; |\n|---|---|\n| 0 |  96 |\n| 1 | 207 |\n\n","text/plain":"  sex n  \n1 0    96\n2 1   207"},"exec_count":28,"output_type":"execute_result"},"2":{"ename":"ERROR","evalue":"Error: `mapping` must be created by `aes()`\n","output_type":"error","traceback":["Error: `mapping` must be created by `aes()`\nTraceback:\n","1. geom_col(fill = \"#E69F00\", \"#56B4E9\")","2. layer(data = data, mapping = mapping, stat = \"identity\", geom = GeomCol, \n .     position = position, show.legend = show.legend, inherit.aes = inherit.aes, \n .     params = list(width = width, na.rm = na.rm, ...))","3. validate_mapping(mapping)","4. abort(msg)","5. signal_abort(cnd)"]}},"pos":52,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":29,"id":"6e7a7b","input":"barplot(table(heart$sex), ylab = \"Count\",border = NA,\n        main = \"Number Women and Men\",col=c(\"#FFCCCC\",\"#99CCFF\"), names.arg=c(\"Women\", \"Men\"))","output":{"0":{"data":{"image/png":"22f2428818ff8e5108bee1b2966de728f8e73834","text/plain":"Plot with title “Number Women and Men”"},"exec_count":29,"output_type":"execute_result"}},"pos":53,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":3,"id":"1c3387","input":"## Data exploration\nstr(heart)","output":{"0":{"name":"stdout","output_type":"stream","text":"'data.frame':\t303 obs. of  14 variables:\n $ age     : int  63 37 41 56 57 57 56 44 52 57 ...\n $ sex     : int  1 1 0 1 0 1 0 1 1 1 ...\n $ cp      : int  3 2 1 1 0 0 1 1 2 2 ...\n $ trestbps: int  145 130 130 120 120 140 140 120 172 150 ...\n $ chol    : int  233 250 204 236 354 192 294 263 199 168 ...\n $ fbs     : int  1 0 0 0 0 0 0 0 1 0 ...\n $ restecg : int  0 1 0 1 1 1 0 1 1 1 ...\n $ thalach : int  150 187 172 178 163 148 153 173 162 174 ...\n $ exang   : int  0 0 0 0 1 0 0 0 0 0 ...\n $ oldpeak : num  2.3 3.5 1.4 0.8 0.6 0.4 1.3 0 0.5 1.6 ...\n $ slope   : int  0 0 2 2 2 1 1 2 2 2 ...\n $ ca      : int  0 0 0 0 0 0 0 0 0 0 ...\n $ thal    : int  1 2 2 2 2 1 2 3 3 2 ...\n $ target  : int  1 1 1 1 1 1 1 1 1 1 ...\n"}},"pos":15,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":30,"id":"e2be06","input":"#Number of no disease cases by Sex\nNodiseasefemale <- sum(heart$target == 0 & heart$sex==0)\nNodiseasemale <- sum(heart$target == 0 & heart$sex==1)\npaste(\"Number of Female patients with no heart disease: \",Nodiseasefemale)\npaste(\"Number of Male patients with no heart disease: \",Nodiseasemale)\n#Number of disease cases by Sex\nDiseasefemale <- sum(heart$target == 1 & heart$sex==0)\nDiseasemale <- sum(heart$target == 1 & heart$sex==1)\npaste(\"Number of Female patients heart disease: \",Diseasefemale)\npaste(\"Number of Male patients with heart disease: \",Diseasemale)","output":{"0":{"data":{"text/html":"<span style=white-space:pre-wrap>'Number of Female patients with no heart disease:  24'</span>","text/latex":"'Number of Female patients with no heart disease:  24'","text/markdown":"<span style=white-space:pre-wrap>'Number of Female patients with no heart disease:  24'</span>","text/plain":"[1] \"Number of Female patients with no heart disease:  24\""},"exec_count":30,"output_type":"execute_result"},"1":{"data":{"text/html":"<span style=white-space:pre-wrap>'Number of Male patients with no heart disease:  114'</span>","text/latex":"'Number of Male patients with no heart disease:  114'","text/markdown":"<span style=white-space:pre-wrap>'Number of Male patients with no heart disease:  114'</span>","text/plain":"[1] \"Number of Male patients with no heart disease:  114\""},"exec_count":30,"output_type":"execute_result"},"2":{"data":{"text/html":"<span style=white-space:pre-wrap>'Number of Female patients heart disease:  72'</span>","text/latex":"'Number of Female patients heart disease:  72'","text/markdown":"<span style=white-space:pre-wrap>'Number of Female patients heart disease:  72'</span>","text/plain":"[1] \"Number of Female patients heart disease:  72\""},"exec_count":30,"output_type":"execute_result"},"3":{"data":{"text/html":"<span style=white-space:pre-wrap>'Number of Male patients with heart disease:  93'</span>","text/latex":"'Number of Male patients with heart disease:  93'","text/markdown":"<span style=white-space:pre-wrap>'Number of Male patients with heart disease:  93'</span>","text/plain":"[1] \"Number of Male patients with heart disease:  93\""},"exec_count":30,"output_type":"execute_result"}},"pos":54,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":31,"id":"8f5400","input":"library(ggplot2)","pos":55,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":32,"id":"f7283e","input":"Sex <- factor(heart$sex)\nggplot(data=heart)+geom_bar(aes(x=factor(target),fill=Sex))+ xlab(\"Target (0=No disease, 1=Disease)\") + \n  ylab(\"Count\")+ggtitle(label=\"Distribution No disease and disease by Gender\")+  theme_bw()","output":{"0":{"data":{"image/png":"b849b660a4706571965fb7ae5d72c3e4057022c1","text/plain":"plot without title"},"exec_count":32,"output_type":"execute_result"}},"pos":56,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":33,"id":"d870d2","input":"library(ggplot2)\nGender <- factor(TargetSex$sex)\nplotsextarget <- ggplot(TargetSex, aes(x=Gender, y=n, fill=factor(target)))+\n  geom_bar(position=\"dodge\", stat=\"identity\")+\n  xlab(\"Sex (0=Female, 1=Male)\") + \n  ylab(\"Count\")                 +\n  ggtitle(\"Female and Male No Heart Disease vs Heart Disease \")  +\n  theme_bw()","pos":58,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":34,"id":"915a55","input":"(TargetSex)\n\nPositivecasesfemale <- TargetSex[ c(3), c(3)]\nPositivecasesmale <- TargetSex[ c(4), c(3)]\nNegativecasesfemale <- TargetSex[ c(1), c(3)]\nNegativecasesmale <- TargetSex[ c(2), c(3)]\n(CountPosNegSex <- matrix(c(Positivecasesfemale,Positivecasesmale, Negativecasesfemale,Negativecasesmale), nrow = 2, dimnames = list(Grupo = c(\"Female\", \"Male\"), Target= c(\"Yes\", \"No\"))))\nprop.table(CountPosNegSex,margin=1)\nprop.test(CountPosNegSex)\n","output":{"0":{"data":{"text/html":"<table>\n<caption>A data.frame: 4 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>sex</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td> 24</td></tr>\n\t<tr><td>0</td><td>1</td><td>114</td></tr>\n\t<tr><td>1</td><td>0</td><td> 72</td></tr>\n\t<tr><td>1</td><td>1</td><td> 93</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 4 × 3\n\\begin{tabular}{lll}\n target & sex & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 &  24\\\\\n\t 0 & 1 & 114\\\\\n\t 1 & 0 &  72\\\\\n\t 1 & 1 &  93\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 4 × 3\n\n| target &lt;int&gt; | sex &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 |  24 |\n| 0 | 1 | 114 |\n| 1 | 0 |  72 |\n| 1 | 1 |  93 |\n\n","text/plain":"  target sex n  \n1 0      0    24\n2 0      1   114\n3 1      0    72\n4 1      1    93"},"exec_count":34,"output_type":"execute_result"},"1":{"data":{"text/html":"<table>\n<caption>A matrix: 2 × 2 of type int</caption>\n<thead>\n\t<tr><th></th><th scope=col>Yes</th><th scope=col>No</th></tr>\n</thead>\n<tbody>\n\t<tr><th scope=row>Female</th><td>72</td><td> 24</td></tr>\n\t<tr><th scope=row>Male</th><td>93</td><td>114</td></tr>\n</tbody>\n</table>\n","text/latex":"A matrix: 2 × 2 of type int\n\\begin{tabular}{r|ll}\n  & Yes & No\\\\\n\\hline\n\tFemale & 72 &  24\\\\\n\tMale & 93 & 114\\\\\n\\end{tabular}\n","text/markdown":"\nA matrix: 2 × 2 of type int\n\n| <!--/--> | Yes | No |\n|---|---|---|\n| Female | 72 |  24 |\n| Male | 93 | 114 |\n\n","text/plain":"        Target\nGrupo    Yes No \n  Female 72   24\n  Male   93  114"},"exec_count":34,"output_type":"execute_result"},"2":{"data":{"text/html":"<table>\n<caption>A matrix: 2 × 2 of type dbl</caption>\n<thead>\n\t<tr><th></th><th scope=col>Yes</th><th scope=col>No</th></tr>\n</thead>\n<tbody>\n\t<tr><th scope=row>Female</th><td>0.7500000</td><td>0.2500000</td></tr>\n\t<tr><th scope=row>Male</th><td>0.4492754</td><td>0.5507246</td></tr>\n</tbody>\n</table>\n","text/latex":"A matrix: 2 × 2 of type dbl\n\\begin{tabular}{r|ll}\n  & Yes & No\\\\\n\\hline\n\tFemale & 0.7500000 & 0.2500000\\\\\n\tMale & 0.4492754 & 0.5507246\\\\\n\\end{tabular}\n","text/markdown":"\nA matrix: 2 × 2 of type dbl\n\n| <!--/--> | Yes | No |\n|---|---|---|\n| Female | 0.7500000 | 0.2500000 |\n| Male | 0.4492754 | 0.5507246 |\n\n","text/plain":"        Target\nGrupo    Yes       No       \n  Female 0.7500000 0.2500000\n  Male   0.4492754 0.5507246"},"exec_count":34,"output_type":"execute_result"},"3":{"data":{"text/plain":"\n\t2-sample test for equality of proportions with continuity correction\n\ndata:  CountPosNegSex\nX-squared = 22.717, df = 1, p-value = 1.877e-06\nalternative hypothesis: two.sided\n95 percent confidence interval:\n 0.1831257 0.4183236\nsample estimates:\n   prop 1    prop 2 \n0.7500000 0.4492754 \n"},"exec_count":34,"output_type":"execute_result"}},"pos":59,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":35,"id":"51464e","input":"library(ggplot2)\ntableTargetcp <- heart%>% count(target,cp)\nstr(tableTargetcp)\n(Targetcp<-as.data.frame(tableTargetcp))\nChestPain <- factor(Targetcp$cp)\nplotcptarget <-ggplot(Targetcp, aes(x=factor(cp), y=n, fill=factor(target)))+\n  geom_bar(position=\"dodge\", stat=\"identity\")+\n  xlab(\" chest pain type (0 = typical angina, 1 = atypical angina, 2 = non-anginal pain, 3 = asymptomatic)\") + \n  ylab(\"Count\")                 +\n  ggtitle(\"Cp vs Heart Disease \")  +\n  theme_bw()","output":{"0":{"name":"stdout","output_type":"stream","text":"tibble [8 × 3] (S3: tbl_df/tbl/data.frame)\n $ target: int [1:8] 0 0 0 0 1 1 1 1\n $ cp    : int [1:8] 0 1 2 3 0 1 2 3\n $ n     : int [1:8] 104 9 18 7 39 41 69 16\n"},"1":{"data":{"text/html":"<table>\n<caption>A data.frame: 8 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>cp</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td>104</td></tr>\n\t<tr><td>0</td><td>1</td><td>  9</td></tr>\n\t<tr><td>0</td><td>2</td><td> 18</td></tr>\n\t<tr><td>0</td><td>3</td><td>  7</td></tr>\n\t<tr><td>1</td><td>0</td><td> 39</td></tr>\n\t<tr><td>1</td><td>1</td><td> 41</td></tr>\n\t<tr><td>1</td><td>2</td><td> 69</td></tr>\n\t<tr><td>1</td><td>3</td><td> 16</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 8 × 3\n\\begin{tabular}{lll}\n target & cp & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 & 104\\\\\n\t 0 & 1 &   9\\\\\n\t 0 & 2 &  18\\\\\n\t 0 & 3 &   7\\\\\n\t 1 & 0 &  39\\\\\n\t 1 & 1 &  41\\\\\n\t 1 & 2 &  69\\\\\n\t 1 & 3 &  16\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 8 × 3\n\n| target &lt;int&gt; | cp &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 | 104 |\n| 0 | 1 |   9 |\n| 0 | 2 |  18 |\n| 0 | 3 |   7 |\n| 1 | 0 |  39 |\n| 1 | 1 |  41 |\n| 1 | 2 |  69 |\n| 1 | 3 |  16 |\n\n","text/plain":"  target cp n  \n1 0      0  104\n2 0      1    9\n3 0      2   18\n4 0      3    7\n5 1      0   39\n6 1      1   41\n7 1      2   69\n8 1      3   16"},"exec_count":35,"output_type":"execute_result"}},"pos":61,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":36,"id":"4fbaea","input":"tableTargetfbs <- heart%>% count(target,fbs)\nstr(tableTargetfbs)\n(Targetfbs<-as.data.frame(tableTargetfbs))\nFastingbloodsugar<- factor(Targetfbs$fbs)\nplotfbstarget<-ggplot(Targetfbs, aes(x=Fastingbloodsugar, y=n, fill=factor(target)))+\n  geom_bar(position=\"dodge\", stat=\"identity\")+\n  xlab(\"Fbs (0=False, 1=True)\") + \n  ylab(\"Count\")                 +\n  ggtitle(\"Fasting blood sugar > 120 mg/dl vs Heart Disease \")  +\n  theme_bw()","output":{"0":{"name":"stdout","output_type":"stream","text":"tibble [4 × 3] (S3: tbl_df/tbl/data.frame)\n $ target: int [1:4] 0 0 1 1\n $ fbs   : int [1:4] 0 1 0 1\n $ n     : int [1:4] 116 22 142 23\n"},"1":{"data":{"text/html":"<table>\n<caption>A data.frame: 4 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>fbs</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td>116</td></tr>\n\t<tr><td>0</td><td>1</td><td> 22</td></tr>\n\t<tr><td>1</td><td>0</td><td>142</td></tr>\n\t<tr><td>1</td><td>1</td><td> 23</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 4 × 3\n\\begin{tabular}{lll}\n target & fbs & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 & 116\\\\\n\t 0 & 1 &  22\\\\\n\t 1 & 0 & 142\\\\\n\t 1 & 1 &  23\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 4 × 3\n\n| target &lt;int&gt; | fbs &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 | 116 |\n| 0 | 1 |  22 |\n| 1 | 0 | 142 |\n| 1 | 1 |  23 |\n\n","text/plain":"  target fbs n  \n1 0      0   116\n2 0      1    22\n3 1      0   142\n4 1      1    23"},"exec_count":36,"output_type":"execute_result"}},"pos":62,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":37,"id":"29f25d","input":"tableTargetexang <- heart%>% count(target,exang)\nstr(tableTargetfbs)\n(Targetexang<-as.data.frame(tableTargetexang))\nExang<- factor(Targetexang$exang)\nplottargetexang <- ggplot(Targetexang, aes(x=Exang, y=n, fill=factor(target)))+\n  geom_bar(position=\"dodge\", stat=\"identity\")+\n  xlab(\"Exercise induced angina (1 = yes; 0 = no)\") + \n  ylab(\"Count\")                 +\n  ggtitle(\"Exercise induced angina vs Heart Disease \")  +\n  theme_bw()\n","output":{"0":{"name":"stdout","output_type":"stream","text":"tibble [4 × 3] (S3: tbl_df/tbl/data.frame)\n $ target: int [1:4] 0 0 1 1\n $ fbs   : int [1:4] 0 1 0 1\n $ n     : int [1:4] 116 22 142 23\n"},"1":{"data":{"text/html":"<table>\n<caption>A data.frame: 4 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>exang</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td> 62</td></tr>\n\t<tr><td>0</td><td>1</td><td> 76</td></tr>\n\t<tr><td>1</td><td>0</td><td>142</td></tr>\n\t<tr><td>1</td><td>1</td><td> 23</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 4 × 3\n\\begin{tabular}{lll}\n target & exang & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 &  62\\\\\n\t 0 & 1 &  76\\\\\n\t 1 & 0 & 142\\\\\n\t 1 & 1 &  23\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 4 × 3\n\n| target &lt;int&gt; | exang &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 |  62 |\n| 0 | 1 |  76 |\n| 1 | 0 | 142 |\n| 1 | 1 |  23 |\n\n","text/plain":"  target exang n  \n1 0      0      62\n2 0      1      76\n3 1      0     142\n4 1      1      23"},"exec_count":37,"output_type":"execute_result"}},"pos":63,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":38,"id":"42121e","input":"tableTargetslope <- heart%>% count(target,slope)\nstr(tableTargetslope)\n(Targetslope<-as.data.frame(tableTargetslope))\nSlope<- factor(Targetslope$slope)\nplottargetslope <- ggplot(Targetslope, aes(x=Slope, y=n, fill=factor(target)))+\n  geom_bar(position=\"dodge\", stat=\"identity\")+\n  xlab(\"The slope of the peak exercise ST segment (0 = upsloping, 1 = flat, 2 = downsloping)\") + \n  ylab(\"Count\")                 +\n  ggtitle(\"Slope vs Heart Disease \")  +\n  theme_bw()","output":{"0":{"name":"stdout","output_type":"stream","text":"tibble [6 × 3] (S3: tbl_df/tbl/data.frame)\n $ target: int [1:6] 0 0 0 1 1 1\n $ slope : int [1:6] 0 1 2 0 1 2\n $ n     : int [1:6] 12 91 35 9 49 107\n"},"1":{"data":{"text/html":"<table>\n<caption>A data.frame: 6 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>slope</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td> 12</td></tr>\n\t<tr><td>0</td><td>1</td><td> 91</td></tr>\n\t<tr><td>0</td><td>2</td><td> 35</td></tr>\n\t<tr><td>1</td><td>0</td><td>  9</td></tr>\n\t<tr><td>1</td><td>1</td><td> 49</td></tr>\n\t<tr><td>1</td><td>2</td><td>107</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 6 × 3\n\\begin{tabular}{lll}\n target & slope & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 &  12\\\\\n\t 0 & 1 &  91\\\\\n\t 0 & 2 &  35\\\\\n\t 1 & 0 &   9\\\\\n\t 1 & 1 &  49\\\\\n\t 1 & 2 & 107\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 6 × 3\n\n| target &lt;int&gt; | slope &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 |  12 |\n| 0 | 1 |  91 |\n| 0 | 2 |  35 |\n| 1 | 0 |   9 |\n| 1 | 1 |  49 |\n| 1 | 2 | 107 |\n\n","text/plain":"  target slope n  \n1 0      0      12\n2 0      1      91\n3 0      2      35\n4 1      0       9\n5 1      1      49\n6 1      2     107"},"exec_count":38,"output_type":"execute_result"}},"pos":64,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":39,"id":"2bc7a4","input":"tableTargetthal <- heart%>% count(target,thal)\nstr(tableTargetthal)\n(Targetthal<-as.data.frame(tableTargetthal))\nThal<- factor(Targetthal$thal)\nplottargetthal <- ggplot(Targetthal, aes(x=Thal, y=n, fill=factor(target)))+\n  geom_bar(position=\"dodge\", stat=\"identity\")+\n  xlab(\" Thal (3 = normal; 6 = fixed defect; 7 = reversable defect)\") + \n  ylab(\"Count\")                 +\n  ggtitle(\"Thal vs Heart Disease \")  +\n  theme_bw()","output":{"0":{"name":"stdout","output_type":"stream","text":"tibble [8 × 3] (S3: tbl_df/tbl/data.frame)\n $ target: int [1:8] 0 0 0 0 1 1 1 1\n $ thal  : int [1:8] 0 1 2 3 0 1 2 3\n $ n     : int [1:8] 1 12 36 89 1 6 130 28\n"},"1":{"data":{"text/html":"<table>\n<caption>A data.frame: 8 × 3</caption>\n<thead>\n\t<tr><th scope=col>target</th><th scope=col>thal</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>0</td><td>0</td><td>  1</td></tr>\n\t<tr><td>0</td><td>1</td><td> 12</td></tr>\n\t<tr><td>0</td><td>2</td><td> 36</td></tr>\n\t<tr><td>0</td><td>3</td><td> 89</td></tr>\n\t<tr><td>1</td><td>0</td><td>  1</td></tr>\n\t<tr><td>1</td><td>1</td><td>  6</td></tr>\n\t<tr><td>1</td><td>2</td><td>130</td></tr>\n\t<tr><td>1</td><td>3</td><td> 28</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 8 × 3\n\\begin{tabular}{lll}\n target & thal & n\\\\\n <int> & <int> & <int>\\\\\n\\hline\n\t 0 & 0 &   1\\\\\n\t 0 & 1 &  12\\\\\n\t 0 & 2 &  36\\\\\n\t 0 & 3 &  89\\\\\n\t 1 & 0 &   1\\\\\n\t 1 & 1 &   6\\\\\n\t 1 & 2 & 130\\\\\n\t 1 & 3 &  28\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 8 × 3\n\n| target &lt;int&gt; | thal &lt;int&gt; | n &lt;int&gt; |\n|---|---|---|\n| 0 | 0 |   1 |\n| 0 | 1 |  12 |\n| 0 | 2 |  36 |\n| 0 | 3 |  89 |\n| 1 | 0 |   1 |\n| 1 | 1 |   6 |\n| 1 | 2 | 130 |\n| 1 | 3 |  28 |\n\n","text/plain":"  target thal n  \n1 0      0      1\n2 0      1     12\n3 0      2     36\n4 0      3     89\n5 1      0      1\n6 1      1      6\n7 1      2    130\n8 1      3     28"},"exec_count":39,"output_type":"execute_result"}},"pos":65,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":4,"id":"326eb5","input":"#is.na(heart)\nsum(is.na(heart))","output":{"0":{"data":{"text/html":"0","text/latex":"0","text/markdown":"0","text/plain":"[1] 0"},"exec_count":4,"output_type":"execute_result"}},"pos":17,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":40,"id":"761668","input":"figure <- ggarrange(plotsextarget, plotcptarget, plotfbstarget, plottargetexang, plottargetslope,plottargetthal,\n                    nrow = 3, ncol=1)\nfigure","output":{"0":{"data":{"text/plain":"$`1`\n\n$`2`\n\nattr(,\"class\")\n[1] \"list\"      \"ggarrange\""},"exec_count":40,"output_type":"execute_result"},"1":{"data":{"image/png":"73d034b4b6b58074180503293242160593b5eb9a","text/plain":"plot without title"},"exec_count":40,"output_type":"execute_result"},"2":{"data":{"image/png":"8e48aea323250ebc44529985552d8769e6fa35c5","text/plain":"plot without title"},"exec_count":40,"output_type":"execute_result"}},"pos":66,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":41,"id":"05f2ed","input":"#asociación variables categoricas\n#heart <- read.csv(\"~/MASTER ESP/MIEBE SECOND SEMESTER/MACHINE LEARNING/FINAL PROJECT/heart.csv\")\n#head(heart)\n#library(\"GoodmanKruskal\")\n#varSet1 <- c(\"sex\", \"cp\", \"exang\",\"fbs\",\"slope\",\"thal\",\"target\")\n#CarFrame1 <- subset(heart, select = varSet1)\n#GKmatrix1 <- GKtauDataframe(CarFrame1)\n#plot(GKmatrix1)\n#heart$thal\n","pos":67,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":42,"id":"d503b0","input":"heartNoTarget <- heart[ , -which(names(heart) %in% c(\"target\"))]\nncol(heartNoTarget)\ncolnames(heartNoTarget)","output":{"0":{"data":{"text/html":"13","text/latex":"13","text/markdown":"13","text/plain":"[1] 13"},"exec_count":42,"output_type":"execute_result"},"1":{"data":{"text/html":"<style>\n.list-inline {list-style: none; margin:0; padding: 0}\n.list-inline>li {display: inline-block}\n.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n</style>\n<ol class=list-inline><li>'age'</li><li>'sex'</li><li>'cp'</li><li>'trestbps'</li><li>'chol'</li><li>'fbs'</li><li>'restecg'</li><li>'thalach'</li><li>'exang'</li><li>'oldpeak'</li><li>'slope'</li><li>'ca'</li><li>'thal'</li></ol>\n","text/latex":"\\begin{enumerate*}\n\\item 'age'\n\\item 'sex'\n\\item 'cp'\n\\item 'trestbps'\n\\item 'chol'\n\\item 'fbs'\n\\item 'restecg'\n\\item 'thalach'\n\\item 'exang'\n\\item 'oldpeak'\n\\item 'slope'\n\\item 'ca'\n\\item 'thal'\n\\end{enumerate*}\n","text/markdown":"1. 'age'\n2. 'sex'\n3. 'cp'\n4. 'trestbps'\n5. 'chol'\n6. 'fbs'\n7. 'restecg'\n8. 'thalach'\n9. 'exang'\n10. 'oldpeak'\n11. 'slope'\n12. 'ca'\n13. 'thal'\n\n\n","text/plain":" [1] \"age\"      \"sex\"      \"cp\"       \"trestbps\" \"chol\"     \"fbs\"     \n [7] \"restecg\"  \"thalach\"  \"exang\"    \"oldpeak\"  \"slope\"    \"ca\"      \n[13] \"thal\"    "},"exec_count":42,"output_type":"execute_result"}},"pos":69,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":43,"id":"92338f","input":"p <- list()\nfor(i in 1:ncol(heartNoTarget)){\n  p[[i]] <- qplot(1:10,10:1,main=i)\n}\ndo.call(grid.arrange,p)","output":{"0":{"data":{"image/png":"e5bf9770145579bd9c5edc2611b738d47c594a65","text/plain":"plot without title"},"exec_count":43,"output_type":"execute_result"}},"pos":70,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":44,"id":"9bcf4e","input":"targetBoxPlot <- list()\n#columnsNoTarget <- colnames(heartNoTarget)\ncolumnsNoTarget <- c('age','sex','cp','trestbps','chol')\n#for (i in 1:ncol(heartNoTarget)){\nfor (i in 1:5){\n    ggplot(data = heart, mapping = aes(x = factor(target), y = columnsNoTarget[i], color = target)) +\n    geom_boxplot()+\n    labs(title=paste(\"target vs\", columnsNoTarget[i]))\n}\n#targetBoxPlot\n\n#do.call(grid.arrange,targetBoxPlot)\n#targetBoxPlot[1]\n#targetBoxPlot[2]","pos":71,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":45,"id":"805528","input":"targetAge <- ggplot(data = heart, mapping = aes(x = factor(target), y = age, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs age\")\n\ntargetSex <- ggplot(data = heart, mapping = aes(x = factor(target), y = sex, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs sex\")\n\ntargetCp <- ggplot(data = heart, mapping = aes(x = factor(target), y = cp, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs cp\")\n\ntargetTrestbps <- ggplot(data = heart, mapping = aes(x = factor(target), y = trestbps, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs trestbps\")\n\ntargetChol <- ggplot(data = heart, mapping = aes(x = factor(target), y = chol, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs chol\")\n\ntargetFbs <- ggplot(data = heart, mapping = aes(x = factor(target), y = fbs, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs fbs\")\ntargetRestecg <- ggplot(data = heart, mapping = aes(x = factor(target), y = restecg, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs restecg\")\n\ntargetThalach <- ggplot(data = heart, mapping = aes(x = factor(target), y = thalach, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs thalach\")\n\ntargetExang <- ggplot(data = heart, mapping = aes(x = factor(target), y = exang, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs exang\")\n\ntargetOldpeak<- ggplot(data = heart, mapping = aes(x = factor(target), y = oldpeak, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs oldpeak\")\n\ntargetSlope <- ggplot(data = heart, mapping = aes(x = factor(target), y = slope, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs slope\")\n\ntargetCa <- ggplot(data = heart, mapping = aes(x = factor(target), y = ca, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs ca\")\n\ntargetThal <- ggplot(data = heart, mapping = aes(x = factor(target), y = thal, color = target)) +\n     geom_boxplot()+\n     labs(title=\"target vs thal\")\n\ngrid.arrange(targetAge, targetSex, targetCp,\n             targetTrestbps, targetChol, targetFbs,\n             targetRestecg, targetThalach, targetExang,\n             targetOldpeak, targetSlope, targetCa,\n             targetThal, ncol = 3)","output":{"0":{"data":{"image/png":"bdb933e022dfa53efb493c4a28f8d91f6f481901","text/plain":"plot without title"},"exec_count":45,"output_type":"execute_result"}},"pos":72,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":46,"id":"c40a86","input":"ggplot(data = heart, mapping = aes(x = thalach, y = chol, color = slope)) +\n  geom_point() +\n  geom_smooth(se = FALSE)","output":{"0":{"name":"stderr","output_type":"stream","text":"`geom_smooth()` using method = 'loess' and formula 'y ~ x'\n"},"1":{"data":{"image/png":"8c9115315baaeffaf1392c414b9a9f9b34978227","text/plain":"plot without title"},"exec_count":46,"output_type":"execute_result"}},"pos":73,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":47,"id":"60c79a","input":"ggplot(data = heart, mapping = aes(x =chol , y = thalach)) +\n  geom_point(mapping = aes(color = slope)) #+\n  #geom_smooth()","output":{"0":{"data":{"image/png":"746fade898c14e738f9593c4d3b7883d049f53d6","text/plain":"plot without title"},"exec_count":47,"output_type":"execute_result"}},"pos":74,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":48,"id":"e4b27e","input":"ggplot(data = heart, mapping = aes(x =trestbps , y = chol)) +\n  geom_point(mapping = aes(color = thal)) #+\n  #geom_smooth()","output":{"0":{"data":{"image/png":"53759b159622b65b87787d97f72fe73e68e9d585","text/plain":"plot without title"},"exec_count":48,"output_type":"execute_result"}},"pos":75,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":49,"id":"2b5ab3","input":"heart$thal[heart$thal == \"0\"] <- NA\nheart%>% count(thal)\nheart_omit <- na.omit(heart)\nheart_omit%>% count(thal)\ndim(heart_omit)","output":{"0":{"data":{"text/html":"<table>\n<caption>A tibble: 4 × 2</caption>\n<thead>\n\t<tr><th scope=col>thal</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td> 1</td><td> 18</td></tr>\n\t<tr><td> 2</td><td>166</td></tr>\n\t<tr><td> 3</td><td>117</td></tr>\n\t<tr><td>NA</td><td>  2</td></tr>\n</tbody>\n</table>\n","text/latex":"A tibble: 4 × 2\n\\begin{tabular}{ll}\n thal & n\\\\\n <int> & <int>\\\\\n\\hline\n\t  1 &  18\\\\\n\t  2 & 166\\\\\n\t  3 & 117\\\\\n\t NA &   2\\\\\n\\end{tabular}\n","text/markdown":"\nA tibble: 4 × 2\n\n| thal &lt;int&gt; | n &lt;int&gt; |\n|---|---|\n|  1 |  18 |\n|  2 | 166 |\n|  3 | 117 |\n| NA |   2 |\n\n","text/plain":"  thal n  \n1  1    18\n2  2   166\n3  3   117\n4 NA     2"},"exec_count":49,"output_type":"execute_result"},"1":{"data":{"text/html":"<table>\n<caption>A tibble: 3 × 2</caption>\n<thead>\n\t<tr><th scope=col>thal</th><th scope=col>n</th></tr>\n\t<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><td>1</td><td> 18</td></tr>\n\t<tr><td>2</td><td>166</td></tr>\n\t<tr><td>3</td><td>117</td></tr>\n</tbody>\n</table>\n","text/latex":"A tibble: 3 × 2\n\\begin{tabular}{ll}\n thal & n\\\\\n <int> & <int>\\\\\n\\hline\n\t 1 &  18\\\\\n\t 2 & 166\\\\\n\t 3 & 117\\\\\n\\end{tabular}\n","text/markdown":"\nA tibble: 3 × 2\n\n| thal &lt;int&gt; | n &lt;int&gt; |\n|---|---|\n| 1 |  18 |\n| 2 | 166 |\n| 3 | 117 |\n\n","text/plain":"  thal n  \n1 1     18\n2 2    166\n3 3    117"},"exec_count":49,"output_type":"execute_result"},"2":{"data":{"text/html":"<style>\n.list-inline {list-style: none; margin:0; padding: 0}\n.list-inline>li {display: inline-block}\n.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n</style>\n<ol class=list-inline><li>301</li><li>14</li></ol>\n","text/latex":"\\begin{enumerate*}\n\\item 301\n\\item 14\n\\end{enumerate*}\n","text/markdown":"1. 301\n2. 14\n\n\n","text/plain":"[1] 301  14"},"exec_count":49,"output_type":"execute_result"}},"pos":78,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":5,"id":"d76248","input":"warning=FALSE #Hide warnings\n\n#Load libraries\nlibrary(ggpubr)\nlibrary(tidyverse)\nlibrary(Hmisc)\nlibrary(corrplot)\nlibrary(purrr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(gridExtra)\nlibrary(dummies)","output":{"0":{"name":"stderr","output_type":"stream","text":"Loading required package: ggplot2\n"},"1":{"name":"stderr","output_type":"stream","text":"Loading required package: magrittr\n"},"10":{"name":"stderr","output_type":"stream","text":"\nAttaching package: ‘Hmisc’\n\n"},"11":{"name":"stderr","output_type":"stream","text":"The following objects are masked from ‘package:dplyr’:\n\n    src, summarize\n\n"},"12":{"name":"stderr","output_type":"stream","text":"The following objects are masked from ‘package:base’:\n\n    format.pval, units\n\n"},"13":{"name":"stderr","output_type":"stream","text":"corrplot 0.84 loaded\n"},"14":{"name":"stderr","output_type":"stream","text":"\nAttaching package: ‘gridExtra’\n\n"},"15":{"name":"stderr","output_type":"stream","text":"The following object is masked from ‘package:dplyr’:\n\n    combine\n\n"},"16":{"name":"stderr","output_type":"stream","text":"dummies-1.5.6 provided by Decision Patterns\n\n"},"2":{"name":"stderr","output_type":"stream","text":"── \u001b[1mAttaching packages\u001b[22m ─────────────────────────────────────── tidyverse 1.3.0 ──\n"},"3":{"name":"stderr","output_type":"stream","text":"\u001b[32m✔\u001b[39m \u001b[34mtibble \u001b[39m 3.0.0     \u001b[32m✔\u001b[39m \u001b[34mdplyr  \u001b[39m 0.8.5\n\u001b[32m✔\u001b[39m \u001b[34mtidyr  \u001b[39m 1.0.2     \u001b[32m✔\u001b[39m \u001b[34mstringr\u001b[39m 1.4.0\n\u001b[32m✔\u001b[39m \u001b[34mreadr  \u001b[39m 1.3.1     \u001b[32m✔\u001b[39m \u001b[34mforcats\u001b[39m 0.5.0\n\u001b[32m✔\u001b[39m \u001b[34mpurrr  \u001b[39m 0.3.4     \n"},"4":{"name":"stderr","output_type":"stream","text":"── \u001b[1mConflicts\u001b[22m ────────────────────────────────────────── tidyverse_conflicts() ──\n\u001b[31m✖\u001b[39m \u001b[34mtidyr\u001b[39m::\u001b[32mextract()\u001b[39m   masks \u001b[34mmagrittr\u001b[39m::extract()\n\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mfilter()\u001b[39m    masks \u001b[34mstats\u001b[39m::filter()\n\u001b[31m✖\u001b[39m \u001b[34mdplyr\u001b[39m::\u001b[32mlag()\u001b[39m       masks \u001b[34mstats\u001b[39m::lag()\n\u001b[31m✖\u001b[39m \u001b[34mpurrr\u001b[39m::\u001b[32mset_names()\u001b[39m masks \u001b[34mmagrittr\u001b[39m::set_names()\n"},"5":{"name":"stderr","output_type":"stream","text":"Loading required package: lattice\n"},"6":{"name":"stderr","output_type":"stream","text":"Loading required package: survival\n"},"7":{"name":"stderr","output_type":"stream","text":"\nAttaching package: ‘survival’\n\n"},"8":{"name":"stderr","output_type":"stream","text":"The following object is masked _by_ ‘.GlobalEnv’:\n\n    heart\n\n"},"9":{"name":"stderr","output_type":"stream","text":"Loading required package: Formula\n"}},"pos":20,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":50,"id":"4574d1","input":"heart_omit","output":{"0":{"name":"stderr","output_type":"stream","text":"WARNING: Some output was deleted.\n"}},"pos":79,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":51,"id":"87ff9e","input":"heartthal <- factor(heart_omit$thal)\ndummies = model.matrix(~heartthal)\n\nheartcp <- factor(heart_omit$cp)\ndummies2 = model.matrix(~heartcp)\n\nheartslope <- factor(heart_omit$slope)\ndummies3 = model.matrix(~heartslope)\ndummies3","output":{"0":{"data":{"text/html":"<table>\n<caption>A matrix: 301 × 3 of type dbl</caption>\n<thead>\n\t<tr><th></th><th scope=col>(Intercept)</th><th scope=col>heartslope1</th><th scope=col>heartslope2</th></tr>\n</thead>\n<tbody>\n\t<tr><th scope=row>1</th><td>1</td><td>0</td><td>0</td></tr>\n\t<tr><th scope=row>2</th><td>1</td><td>0</td><td>0</td></tr>\n\t<tr><th scope=row>3</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>4</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>5</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>6</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>7</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>8</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>9</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>10</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>11</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>12</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>13</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>14</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>15</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>16</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>17</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>18</th><td>1</td><td>0</td><td>0</td></tr>\n\t<tr><th scope=row>19</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>20</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>21</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>22</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>23</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>24</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>25</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>26</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>27</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>28</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>29</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>30</th><td>1</td><td>0</td><td>0</td></tr>\n\t<tr><th scope=row>⋮</th><td>⋮</td><td>⋮</td><td>⋮</td></tr>\n\t<tr><th scope=row>272</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>273</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>274</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>275</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>276</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>277</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>278</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>279</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>280</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>281</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>282</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>283</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>284</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>285</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>286</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>287</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>288</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>289</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>290</th><td>1</td><td>0</td><td>0</td></tr>\n\t<tr><th scope=row>291</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>292</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>293</th><td>1</td><td>0</td><td>0</td></tr>\n\t<tr><th scope=row>294</th><td>1</td><td>0</td><td>1</td></tr>\n\t<tr><th scope=row>295</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>296</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>297</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>298</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>299</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>300</th><td>1</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>301</th><td>1</td><td>1</td><td>0</td></tr>\n</tbody>\n</table>\n","text/latex":"A matrix: 301 × 3 of type dbl\n\\begin{tabular}{r|lll}\n  & (Intercept) & heartslope1 & heartslope2\\\\\n\\hline\n\t1 & 1 & 0 & 0\\\\\n\t2 & 1 & 0 & 0\\\\\n\t3 & 1 & 0 & 1\\\\\n\t4 & 1 & 0 & 1\\\\\n\t5 & 1 & 0 & 1\\\\\n\t6 & 1 & 1 & 0\\\\\n\t7 & 1 & 1 & 0\\\\\n\t8 & 1 & 0 & 1\\\\\n\t9 & 1 & 0 & 1\\\\\n\t10 & 1 & 0 & 1\\\\\n\t11 & 1 & 0 & 1\\\\\n\t12 & 1 & 0 & 1\\\\\n\t13 & 1 & 0 & 1\\\\\n\t14 & 1 & 1 & 0\\\\\n\t15 & 1 & 0 & 1\\\\\n\t16 & 1 & 1 & 0\\\\\n\t17 & 1 & 0 & 1\\\\\n\t18 & 1 & 0 & 0\\\\\n\t19 & 1 & 0 & 1\\\\\n\t20 & 1 & 0 & 1\\\\\n\t21 & 1 & 1 & 0\\\\\n\t22 & 1 & 0 & 1\\\\\n\t23 & 1 & 0 & 1\\\\\n\t24 & 1 & 1 & 0\\\\\n\t25 & 1 & 0 & 1\\\\\n\t26 & 1 & 0 & 1\\\\\n\t27 & 1 & 0 & 1\\\\\n\t28 & 1 & 0 & 1\\\\\n\t29 & 1 & 0 & 1\\\\\n\t30 & 1 & 0 & 0\\\\\n\t⋮ & ⋮ & ⋮ & ⋮\\\\\n\t272 & 1 & 1 & 0\\\\\n\t273 & 1 & 0 & 1\\\\\n\t274 & 1 & 1 & 0\\\\\n\t275 & 1 & 0 & 1\\\\\n\t276 & 1 & 1 & 0\\\\\n\t277 & 1 & 0 & 1\\\\\n\t278 & 1 & 0 & 1\\\\\n\t279 & 1 & 1 & 0\\\\\n\t280 & 1 & 1 & 0\\\\\n\t281 & 1 & 1 & 0\\\\\n\t282 & 1 & 0 & 1\\\\\n\t283 & 1 & 0 & 1\\\\\n\t284 & 1 & 1 & 0\\\\\n\t285 & 1 & 0 & 1\\\\\n\t286 & 1 & 0 & 1\\\\\n\t287 & 1 & 1 & 0\\\\\n\t288 & 1 & 1 & 0\\\\\n\t289 & 1 & 0 & 1\\\\\n\t290 & 1 & 0 & 0\\\\\n\t291 & 1 & 1 & 0\\\\\n\t292 & 1 & 1 & 0\\\\\n\t293 & 1 & 0 & 0\\\\\n\t294 & 1 & 0 & 1\\\\\n\t295 & 1 & 1 & 0\\\\\n\t296 & 1 & 1 & 0\\\\\n\t297 & 1 & 1 & 0\\\\\n\t298 & 1 & 1 & 0\\\\\n\t299 & 1 & 1 & 0\\\\\n\t300 & 1 & 1 & 0\\\\\n\t301 & 1 & 1 & 0\\\\\n\\end{tabular}\n","text/markdown":"\nA matrix: 301 × 3 of type dbl\n\n| <!--/--> | (Intercept) | heartslope1 | heartslope2 |\n|---|---|---|---|\n| 1 | 1 | 0 | 0 |\n| 2 | 1 | 0 | 0 |\n| 3 | 1 | 0 | 1 |\n| 4 | 1 | 0 | 1 |\n| 5 | 1 | 0 | 1 |\n| 6 | 1 | 1 | 0 |\n| 7 | 1 | 1 | 0 |\n| 8 | 1 | 0 | 1 |\n| 9 | 1 | 0 | 1 |\n| 10 | 1 | 0 | 1 |\n| 11 | 1 | 0 | 1 |\n| 12 | 1 | 0 | 1 |\n| 13 | 1 | 0 | 1 |\n| 14 | 1 | 1 | 0 |\n| 15 | 1 | 0 | 1 |\n| 16 | 1 | 1 | 0 |\n| 17 | 1 | 0 | 1 |\n| 18 | 1 | 0 | 0 |\n| 19 | 1 | 0 | 1 |\n| 20 | 1 | 0 | 1 |\n| 21 | 1 | 1 | 0 |\n| 22 | 1 | 0 | 1 |\n| 23 | 1 | 0 | 1 |\n| 24 | 1 | 1 | 0 |\n| 25 | 1 | 0 | 1 |\n| 26 | 1 | 0 | 1 |\n| 27 | 1 | 0 | 1 |\n| 28 | 1 | 0 | 1 |\n| 29 | 1 | 0 | 1 |\n| 30 | 1 | 0 | 0 |\n| ⋮ | ⋮ | ⋮ | ⋮ |\n| 272 | 1 | 1 | 0 |\n| 273 | 1 | 0 | 1 |\n| 274 | 1 | 1 | 0 |\n| 275 | 1 | 0 | 1 |\n| 276 | 1 | 1 | 0 |\n| 277 | 1 | 0 | 1 |\n| 278 | 1 | 0 | 1 |\n| 279 | 1 | 1 | 0 |\n| 280 | 1 | 1 | 0 |\n| 281 | 1 | 1 | 0 |\n| 282 | 1 | 0 | 1 |\n| 283 | 1 | 0 | 1 |\n| 284 | 1 | 1 | 0 |\n| 285 | 1 | 0 | 1 |\n| 286 | 1 | 0 | 1 |\n| 287 | 1 | 1 | 0 |\n| 288 | 1 | 1 | 0 |\n| 289 | 1 | 0 | 1 |\n| 290 | 1 | 0 | 0 |\n| 291 | 1 | 1 | 0 |\n| 292 | 1 | 1 | 0 |\n| 293 | 1 | 0 | 0 |\n| 294 | 1 | 0 | 1 |\n| 295 | 1 | 1 | 0 |\n| 296 | 1 | 1 | 0 |\n| 297 | 1 | 1 | 0 |\n| 298 | 1 | 1 | 0 |\n| 299 | 1 | 1 | 0 |\n| 300 | 1 | 1 | 0 |\n| 301 | 1 | 1 | 0 |\n\n","text/plain":"    (Intercept) heartslope1 heartslope2\n1   1           0           0          \n2   1           0           0          \n3   1           0           1          \n4   1           0           1          \n5   1           0           1          \n6   1           1           0          \n7   1           1           0          \n8   1           0           1          \n9   1           0           1          \n10  1           0           1          \n11  1           0           1          \n12  1           0           1          \n13  1           0           1          \n14  1           1           0          \n15  1           0           1          \n16  1           1           0          \n17  1           0           1          \n18  1           0           0          \n19  1           0           1          \n20  1           0           1          \n21  1           1           0          \n22  1           0           1          \n23  1           0           1          \n24  1           1           0          \n25  1           0           1          \n26  1           0           1          \n27  1           0           1          \n28  1           0           1          \n29  1           0           1          \n30  1           0           0          \n⋮   ⋮           ⋮           ⋮          \n272 1           1           0          \n273 1           0           1          \n274 1           1           0          \n275 1           0           1          \n276 1           1           0          \n277 1           0           1          \n278 1           0           1          \n279 1           1           0          \n280 1           1           0          \n281 1           1           0          \n282 1           0           1          \n283 1           0           1          \n284 1           1           0          \n285 1           0           1          \n286 1           0           1          \n287 1           1           0          \n288 1           1           0          \n289 1           0           1          \n290 1           0           0          \n291 1           1           0          \n292 1           1           0          \n293 1           0           0          \n294 1           0           1          \n295 1           1           0          \n296 1           1           0          \n297 1           1           0          \n298 1           1           0          \n299 1           1           0          \n300 1           1           0          \n301 1           1           0          "},"exec_count":51,"output_type":"execute_result"}},"pos":81,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":52,"id":"2aedab","input":"result1 <- cbind(heart_omit,dummy(heart_omit$cp,sep=\"cp\"))\nresult2 <- cbind(result1,dummy(result1$slope,sep=\"slope\"))\nheartlabel <- cbind(result2,dummy(result2$thal,sep=\"thal\"))\nhead(heartlabel)","output":{"0":{"name":"stderr","output_type":"stream","text":"Warning message in model.matrix.default(~x - 1, model.frame(~x - 1), contrasts = FALSE):\n“non-list contrasts argument ignored”"},"1":{"name":"stderr","output_type":"stream","text":"Warning message in model.matrix.default(~x - 1, model.frame(~x - 1), contrasts = FALSE):\n“non-list contrasts argument ignored”"},"2":{"name":"stderr","output_type":"stream","text":"Warning message in model.matrix.default(~x - 1, model.frame(~x - 1), contrasts = FALSE):\n“non-list contrasts argument ignored”"},"3":{"data":{"text/html":"<table>\n<caption>A data.frame: 6 × 24</caption>\n<thead>\n\t<tr><th></th><th scope=col>age</th><th scope=col>sex</th><th scope=col>cp</th><th scope=col>trestbps</th><th scope=col>chol</th><th scope=col>fbs</th><th scope=col>restecg</th><th scope=col>thalach</th><th scope=col>exang</th><th scope=col>oldpeak</th><th scope=col>⋯</th><th scope=col>NAcp0</th><th scope=col>NAcp1</th><th scope=col>NAcp2</th><th scope=col>NAcp3</th><th scope=col>NAslope0</th><th scope=col>NAslope1</th><th scope=col>NAslope2</th><th scope=col>NAthal1</th><th scope=col>NAthal2</th><th scope=col>NAthal3</th></tr>\n\t<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>⋯</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>\n</thead>\n<tbody>\n\t<tr><th scope=row>1</th><td>63</td><td>1</td><td>3</td><td>145</td><td>233</td><td>1</td><td>0</td><td>150</td><td>0</td><td>2.3</td><td>⋯</td><td>0</td><td>0</td><td>0</td><td>1</td><td>1</td><td>0</td><td>0</td><td>1</td><td>0</td><td>0</td></tr>\n\t<tr><th scope=row>2</th><td>37</td><td>1</td><td>2</td><td>130</td><td>250</td><td>0</td><td>1</td><td>187</td><td>0</td><td>3.5</td><td>⋯</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>3</th><td>41</td><td>0</td><td>1</td><td>130</td><td>204</td><td>0</td><td>0</td><td>172</td><td>0</td><td>1.4</td><td>⋯</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>4</th><td>56</td><td>1</td><td>1</td><td>120</td><td>236</td><td>0</td><td>1</td><td>178</td><td>0</td><td>0.8</td><td>⋯</td><td>0</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>5</th><td>57</td><td>0</td><td>0</td><td>120</td><td>354</td><td>0</td><td>1</td><td>163</td><td>1</td><td>0.6</td><td>⋯</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td></tr>\n\t<tr><th scope=row>6</th><td>57</td><td>1</td><td>0</td><td>140</td><td>192</td><td>0</td><td>1</td><td>148</td><td>0</td><td>0.4</td><td>⋯</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td><td>1</td><td>0</td><td>0</td></tr>\n</tbody>\n</table>\n","text/latex":"A data.frame: 6 × 24\n\\begin{tabular}{r|lllllllllllllllllllll}\n  & age & sex & cp & trestbps & chol & fbs & restecg & thalach & exang & oldpeak & ⋯ & NAcp0 & NAcp1 & NAcp2 & NAcp3 & NAslope0 & NAslope1 & NAslope2 & NAthal1 & NAthal2 & NAthal3\\\\\n  & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <dbl> & ⋯ & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int> & <int>\\\\\n\\hline\n\t1 & 63 & 1 & 3 & 145 & 233 & 1 & 0 & 150 & 0 & 2.3 & ⋯ & 0 & 0 & 0 & 1 & 1 & 0 & 0 & 1 & 0 & 0\\\\\n\t2 & 37 & 1 & 2 & 130 & 250 & 0 & 1 & 187 & 0 & 3.5 & ⋯ & 0 & 0 & 1 & 0 & 1 & 0 & 0 & 0 & 1 & 0\\\\\n\t3 & 41 & 0 & 1 & 130 & 204 & 0 & 0 & 172 & 0 & 1.4 & ⋯ & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0\\\\\n\t4 & 56 & 1 & 1 & 120 & 236 & 0 & 1 & 178 & 0 & 0.8 & ⋯ & 0 & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0\\\\\n\t5 & 57 & 0 & 0 & 120 & 354 & 0 & 1 & 163 & 1 & 0.6 & ⋯ & 1 & 0 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0\\\\\n\t6 & 57 & 1 & 0 & 140 & 192 & 0 & 1 & 148 & 0 & 0.4 & ⋯ & 1 & 0 & 0 & 0 & 0 & 1 & 0 & 1 & 0 & 0\\\\\n\\end{tabular}\n","text/markdown":"\nA data.frame: 6 × 24\n\n| <!--/--> | age &lt;int&gt; | sex &lt;int&gt; | cp &lt;int&gt; | trestbps &lt;int&gt; | chol &lt;int&gt; | fbs &lt;int&gt; | restecg &lt;int&gt; | thalach &lt;int&gt; | exang &lt;int&gt; | oldpeak &lt;dbl&gt; | ⋯ ⋯ | NAcp0 &lt;int&gt; | NAcp1 &lt;int&gt; | NAcp2 &lt;int&gt; | NAcp3 &lt;int&gt; | NAslope0 &lt;int&gt; | NAslope1 &lt;int&gt; | NAslope2 &lt;int&gt; | NAthal1 &lt;int&gt; | NAthal2 &lt;int&gt; | NAthal3 &lt;int&gt; |\n|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|\n| 1 | 63 | 1 | 3 | 145 | 233 | 1 | 0 | 150 | 0 | 2.3 | ⋯ | 0 | 0 | 0 | 1 | 1 | 0 | 0 | 1 | 0 | 0 |\n| 2 | 37 | 1 | 2 | 130 | 250 | 0 | 1 | 187 | 0 | 3.5 | ⋯ | 0 | 0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 | 0 |\n| 3 | 41 | 0 | 1 | 130 | 204 | 0 | 0 | 172 | 0 | 1.4 | ⋯ | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |\n| 4 | 56 | 1 | 1 | 120 | 236 | 0 | 1 | 178 | 0 | 0.8 | ⋯ | 0 | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |\n| 5 | 57 | 0 | 0 | 120 | 354 | 0 | 1 | 163 | 1 | 0.6 | ⋯ | 1 | 0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |\n| 6 | 57 | 1 | 0 | 140 | 192 | 0 | 1 | 148 | 0 | 0.4 | ⋯ | 1 | 0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 | 0 |\n\n","text/plain":"  age sex cp trestbps chol fbs restecg thalach exang oldpeak ⋯ NAcp0 NAcp1\n1 63  1   3  145      233  1   0       150     0     2.3     ⋯ 0     0    \n2 37  1   2  130      250  0   1       187     0     3.5     ⋯ 0     0    \n3 41  0   1  130      204  0   0       172     0     1.4     ⋯ 0     1    \n4 56  1   1  120      236  0   1       178     0     0.8     ⋯ 0     1    \n5 57  0   0  120      354  0   1       163     1     0.6     ⋯ 1     0    \n6 57  1   0  140      192  0   1       148     0     0.4     ⋯ 1     0    \n  NAcp2 NAcp3 NAslope0 NAslope1 NAslope2 NAthal1 NAthal2 NAthal3\n1 0     1     1        0        0        1       0       0      \n2 1     0     1        0        0        0       1       0      \n3 0     0     0        0        1        0       1       0      \n4 0     0     0        0        1        0       1       0      \n5 0     0     0        0        1        0       1       0      \n6 0     0     0        1        0        1       0       0      "},"exec_count":52,"output_type":"execute_result"}},"pos":83,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":53,"id":"e8e652","input":"str(heartlabel)","output":{"0":{"name":"stdout","output_type":"stream","text":"'data.frame':\t301 obs. of  24 variables:\n $ age     : int  63 37 41 56 57 57 56 44 52 57 ...\n $ sex     : int  1 1 0 1 0 1 0 1 1 1 ...\n $ cp      : int  3 2 1 1 0 0 1 1 2 2 ...\n $ trestbps: int  145 130 130 120 120 140 140 120 172 150 ...\n $ chol    : int  233 250 204 236 354 192 294 263 199 168 ...\n $ fbs     : int  1 0 0 0 0 0 0 0 1 0 ...\n $ restecg : int  0 1 0 1 1 1 0 1 1 1 ...\n $ thalach : int  150 187 172 178 163 148 153 173 162 174 ...\n $ exang   : int  0 0 0 0 1 0 0 0 0 0 ...\n $ oldpeak : num  2.3 3.5 1.4 0.8 0.6 0.4 1.3 0 0.5 1.6 ...\n $ slope   : int  0 0 2 2 2 1 1 2 2 2 ...\n $ ca      : int  0 0 0 0 0 0 0 0 0 0 ...\n $ thal    : int  1 2 2 2 2 1 2 3 3 2 ...\n $ target  : int  1 1 1 1 1 1 1 1 1 1 ...\n $ NAcp0   : int  0 0 0 0 1 1 0 0 0 0 ...\n $ NAcp1   : int  0 0 1 1 0 0 1 1 0 0 ...\n $ NAcp2   : int  0 1 0 0 0 0 0 0 1 1 ...\n $ NAcp3   : int  1 0 0 0 0 0 0 0 0 0 ...\n $ NAslope0: int  1 1 0 0 0 0 0 0 0 0 ...\n $ NAslope1: int  0 0 0 0 0 1 1 0 0 0 ...\n $ NAslope2: int  0 0 1 1 1 0 0 1 1 1 ...\n $ NAthal1 : int  1 0 0 0 0 1 0 0 0 0 ...\n $ NAthal2 : int  0 1 1 1 1 0 1 0 0 1 ...\n $ NAthal3 : int  0 0 0 0 0 0 0 1 1 0 ...\n"}},"pos":84,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":54,"id":"2aacb3","input":"#Function to normalize\nnormalize <- function(x) {\n            return ((x - min(x)) / (max(x) - min(x)))\n            }","pos":87,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":55,"id":"6ce131","input":"# New dataframe with features normalized\n(heartNorm <- as.data.frame(apply(heartlabel, 2, normalize)))","output":{"0":{"name":"stderr","output_type":"stream","text":"WARNING: Some output was deleted.\n"}},"pos":88,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":56,"id":"55e116","input":"train <- sample(1:nrow(heartNorm), nrow(heartNorm)/2)\nheart_train <- heartNorm[train,]\nheart_test<- heartNorm[-train,]\ndim(heart_test)\ndim(heart_train)\n","output":{"0":{"data":{"text/html":"<style>\n.list-inline {list-style: none; margin:0; padding: 0}\n.list-inline>li {display: inline-block}\n.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n</style>\n<ol class=list-inline><li>151</li><li>24</li></ol>\n","text/latex":"\\begin{enumerate*}\n\\item 151\n\\item 24\n\\end{enumerate*}\n","text/markdown":"1. 151\n2. 24\n\n\n","text/plain":"[1] 151  24"},"exec_count":56,"output_type":"execute_result"},"1":{"data":{"text/html":"<style>\n.list-inline {list-style: none; margin:0; padding: 0}\n.list-inline>li {display: inline-block}\n.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n</style>\n<ol class=list-inline><li>150</li><li>24</li></ol>\n","text/latex":"\\begin{enumerate*}\n\\item 150\n\\item 24\n\\end{enumerate*}\n","text/markdown":"1. 150\n2. 24\n\n\n","text/plain":"[1] 150  24"},"exec_count":56,"output_type":"execute_result"}},"pos":90,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":59,"id":"a764b3","input":"heartNormPCA <-prcomp(x = heartNorm, scale = FALSE, center = TRUE)","pos":99,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":6,"id":"06f7c5","input":"# Dataframe with only numeric variables\nheart_numeric <- heart[ , -which(names(heart) %in% c(\"sex\",\"cp\",\"fbs\",\"exang\",\"slope\",\"thal\"))]\ndim(heart_numeric)","output":{"0":{"data":{"text/html":"<style>\n.list-inline {list-style: none; margin:0; padding: 0}\n.list-inline>li {display: inline-block}\n.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n</style>\n<ol class=list-inline><li>303</li><li>8</li></ol>\n","text/latex":"\\begin{enumerate*}\n\\item 303\n\\item 8\n\\end{enumerate*}\n","text/markdown":"1. 303\n2. 8\n\n\n","text/plain":"[1] 303   8"},"exec_count":6,"output_type":"execute_result"}},"pos":23,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":60,"id":"b34b2c","input":"summary(heartNormPCA)","output":{"0":{"data":{"text/plain":"Importance of components:\n                          PC1    PC2    PC3     PC4     PC5     PC6     PC7\nStandard deviation     1.0096 0.6559 0.6092 0.45497 0.43673 0.38301 0.37393\nProportion of Variance 0.3226 0.1362 0.1174 0.06551 0.06036 0.04642 0.04425\nCumulative Proportion  0.3226 0.4587 0.5761 0.64165 0.70201 0.74843 0.79268\n                           PC8     PC9    PC10    PC11   PC12    PC13    PC14\nStandard deviation     0.35630 0.33544 0.32959 0.30225 0.2520 0.22614 0.18318\nProportion of Variance 0.04017 0.03561 0.03438 0.02891 0.0201 0.01618 0.01062\nCumulative Proportion  0.83285 0.86846 0.90284 0.93175 0.9518 0.96803 0.97865\n                         PC15    PC16   PC17    PC18      PC19      PC20\nStandard deviation     0.1529 0.13440 0.1219 0.10568 1.577e-16 1.115e-16\nProportion of Variance 0.0074 0.00572 0.0047 0.00353 0.000e+00 0.000e+00\nCumulative Proportion  0.9860 0.99177 0.9965 1.00000 1.000e+00 1.000e+00\n                            PC21      PC22      PC23      PC24\nStandard deviation     1.041e-16 9.177e-17 8.219e-17 6.731e-17\nProportion of Variance 0.000e+00 0.000e+00 0.000e+00 0.000e+00\nCumulative Proportion  1.000e+00 1.000e+00 1.000e+00 1.000e+00"},"exec_count":60,"output_type":"execute_result"}},"pos":100,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":61,"id":"aecb5f","input":"biplot(heartNormPCA)","output":{"0":{"data":{"image/png":"0ef1c348517abc67dc985574aef7d3616c0609ab","text/plain":"plot without title"},"exec_count":61,"output_type":"execute_result"}},"pos":101,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":62,"id":"5642f4","input":"#Getting proportion of variance","pos":103,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":64,"id":"7633c5","input":"library(\"MASS\")\nlinear <- lda(target~.,data=heartNorm)\nlinear\np <- predict(linear,heart_train)\n\n","output":{"0":{"name":"stderr","output_type":"stream","text":"Warning message in lda.default(x, grouping, ...):\n“variables are collinear”"},"1":{"data":{"text/plain":"Call:\nlda(target ~ ., data = heartNorm)\n\nPrior probabilities of groups:\n        0         1 \n0.4551495 0.5448505 \n\nGroup means:\n        age       sex        cp  trestbps      chol       fbs   restecg\n0 0.5757299 0.8248175 0.1605839 0.3815590 0.2863714 0.1532847 0.2226277\n1 0.4894563 0.5670732 0.4573171 0.3331224 0.2657312 0.1402439 0.2987805\n    thalach     exang    oldpeak     slope         ca      thal     NAcp0\n0 0.5189168 0.5474453 0.25641629 0.5839416 0.29379562 0.7810219 0.7518248\n1 0.6697077 0.1402439 0.09461054 0.7957317 0.09146341 0.5670732 0.2378049\n       NAcp1     NAcp2      NAcp3   NAslope0  NAslope1  NAslope2    NAthal1\n0 0.06569343 0.1313869 0.05109489 0.08759124 0.6569343 0.2554745 0.08759124\n1 0.25000000 0.4146341 0.09756098 0.05487805 0.2987805 0.6463415 0.03658537\n    NAthal2   NAthal3\n0 0.2627737 0.6496350\n1 0.7926829 0.1707317\n\nCoefficients of linear discriminants:\n                 LD1\nage      -0.08745309\nsex      -0.59696473\ncp        0.49123086\ntrestbps -0.69776232\nchol     -0.65863964\nfbs       0.13264284\nrestecg   0.41138379\nthalach   1.15609488\nexang    -0.43508318\noldpeak  -1.37753403\nslope     0.12488271\nca       -1.51445946\nthal     -0.35146913\nNAcp0    -0.40183455\nNAcp1     0.14465157\nNAcp2     0.22840925\nNAcp3     0.18448166\nNAslope0  0.22054021\nNAslope1 -0.22799233\nNAslope2  0.16653430\nNAthal1  -0.17026549\nNAthal2   0.39814054\nNAthal3  -0.33911703"},"exec_count":64,"output_type":"execute_result"}},"pos":92,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":68,"id":"f38479","input":"ldahist(data = p$x[, 1], g= heart_train$target)","output":{"0":{"data":{"image/png":"3c6f70d88036fff7c822afe0ea2a05f3cdf1ba5d","text/plain":"plot without title"},"exec_count":68,"output_type":"execute_result"}},"pos":93,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":7,"id":"d64a61","input":"# Correlation matrix and plot\ncorrelation <- cor(heart_numeric)\ncol <- colorRampPalette(c(\"#BB4444\", \"#EE9988\", \"#FFFFFF\", \"#77AADD\", \"#4477AA\"))\ncorrplot(correlation, method = \"color\", col = col(200),\n         type = \"upper\", order = \"hclust\",\n         addCoef.col = \"black\", # Add coefficient of correlation\n         tl.col = \"darkblue\", tl.srt = 45, #Text label color and rotation\n         )","output":{"0":{"data":{"image/png":"f215d5e2f3ee24918053124475e4f4396981b617","text/plain":"Plot with title “”"},"exec_count":7,"output_type":"execute_result"}},"pos":24,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":75,"id":"fe057e","input":"#My test\ndata(iris)\nstr(iris)","output":{"0":{"name":"stdout","output_type":"stream","text":"'data.frame':\t150 obs. of  5 variables:\n $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...\n $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...\n $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...\n $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...\n $ Species     : Factor w/ 3 levels \"setosa\",\"versicolor\",..: 1 1 1 1 1 1 1 1 1 1 ...\n"}},"pos":106,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":8,"id":"e18f6a","input":"heart_numeric %>%\n  gather() %>%\n  ggplot(aes(value)) +\n    facet_wrap(~ key, scales = \"free\") +\n    geom_histogram()","output":{"0":{"name":"stderr","output_type":"stream","text":"`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n"},"1":{"data":{"image/png":"d0d43f17d246ae04ade51201c15d976c95d19518","text/plain":"plot without title"},"exec_count":8,"output_type":"execute_result"}},"pos":26,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":81,"id":"1b630c","input":"#Confusion Matrix testing testing data\np1<- predict(linear, heart_train)$class\ntab <- table(Predicted=p1, Actual=heart_train$target)\n#tab\n(AccuracyTrainLDA <- sum(diag(tab))/sum(tab))\n\n#Confusion Matrix testing training data\np2<- predict(linear, heart_test)$class\ntab2 <- table(Predicted=p2, Actual=heart_test$target)\n(AccuracyTestLDA <- sum(diag(tab2))/sum(tab2))","output":{"0":{"data":{"text/html":"0.9","text/latex":"0.9","text/markdown":"0.9","text/plain":"[1] 0.9"},"exec_count":81,"output_type":"execute_result"},"1":{"data":{"text/html":"0.80794701986755","text/latex":"0.80794701986755","text/markdown":"0.80794701986755","text/plain":"[1] 0.807947"},"exec_count":81,"output_type":"execute_result"}},"pos":94,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":82,"id":"cd221e","input":"library(psych)\npairs.panels(iris[1:4],\n            bg = c(\"red\", \"green\",\"blue\")[iris$Species],\n            pch = 21)","output":{"0":{"name":"stderr","output_type":"stream","text":"\nAttaching package: ‘psych’\n\n"},"1":{"name":"stderr","output_type":"stream","text":"The following object is masked from ‘package:Hmisc’:\n\n    describe\n\n"},"2":{"name":"stderr","output_type":"stream","text":"The following objects are masked from ‘package:ggplot2’:\n\n    %+%, alpha\n\n"},"3":{"data":{"image/png":"02eb29e4a65bf40c027f662600c8e0ac70a3631b","text/plain":"plot without title"},"exec_count":82,"output_type":"execute_result"}},"pos":108,"scrolled":true,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":83,"id":"f9b7f0","input":"dim(heart_numeric)","output":{"0":{"data":{"text/html":"<style>\n.list-inline {list-style: none; margin:0; padding: 0}\n.list-inline>li {display: inline-block}\n.list-inline>li:not(:last-child)::after {content: \"\\00b7\"; padding: 0 .5ex}\n</style>\n<ol class=list-inline><li>303</li><li>8</li></ol>\n","text/latex":"\\begin{enumerate*}\n\\item 303\n\\item 8\n\\end{enumerate*}\n","text/markdown":"1. 303\n2. 8\n\n\n","text/plain":"[1] 303   8"},"exec_count":83,"output_type":"execute_result"}},"pos":107,"state":"done","type":"cell"}
{"cell_type":"code","exec_count":9,"id":"9900a3","input":"# Scatter plot comparing thalach-oldpeak and age-chol, with color representing target\np1 <- ggplot(heart_numeric,aes(x=thalach, y=oldpeak, color=target))+\ngeom_point()\np2 <- ggplot(heart_numeric,aes(x=age, y=chol, color=target))+\ngeom_point()\ngrid.arrange(p1, p2, nrow = 1)#subplot","output":{"0":{"data":{"image/png":"0cda2ebf2be96e7043e055f9d495927f19c65619","text/plain":"plot without title"},"exec_count":9,"output_type":"execute_result"}},"pos":28,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"0ca67b","input":"###### Distribution - Histogram","pos":25,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"0d696f","input":"### Data description <a class=\"anchor\" id=\"dd\"></a>","pos":8,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"1a6a6e","input":"###### Correlation","pos":22,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"1c820d","input":"It presents a more even distribution of the loading vectors (because of the scaling)","pos":102,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"1e0ad6","input":"#### Identify and treat \"NaN\" values","pos":16,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"2ad661","input":"#### Intercept Model matrix","pos":80,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"2fea72","input":"# Final project Machine Learning 2019-2020\n#### Master in Innovation and Entrepreneurship in Biomedical Engineering\n##### Authors: Arantxa Palma Rotaeche, Mónica Tuta","pos":1,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"32a8d5","input":"Conclusion: LDA do not help us to have a clear separation between the two groups as it can be seen in the past histogram, both variables were not maximally separated. LDA only makes sense in a multiclass setting.","pos":96,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"3cf9e1","input":"- age - age in years\n- **sex** - (1 = male; 0 = female)\n- **cp** - chest pain type (0 = typical angina, 1 = atypical angina, 2 = non-anginal pain, 3 = asymptomatic)\n- trestbps - resting blood pressure (in mm Hg on admission to the hospital)\n- chol - serum cholestoral in mg/dl\n- **fbs** - (fasting blood sugar > 120 mg/dl) (1 = true; 0 = false)\n- restecg - resting electrocardiographic results (0= normal, 1= having ST-T wave abnormality (T wave inversions and/or ST \n                    elevation or depression of > 0.05 mV), 2= showing probable or definite left ventricular hypertrophy)\n- thalach - maximum heart rate achieved\n- **exang** - exercise induced angina (1 = yes; 0 = no)\n- oldpeak - ST depression induced by exercise relative to rest\n- **slope** - the slope of the peak exercise ST segment (0 = upsloping, 1 = flat, 2 = downsloping)\n- ca - number of major vessels (0-3) colored by flourosopy\n- **thal** - (3 = normal; 6 = fixed defect; 7 = reversable defect)\n- **target** - have disease or not (1=yes, 0=no)\n\n\n**Bold** features are categorical\n\n***Creators***:\n1. Hungarian Institute of Cardiology. Budapest: Andras Janosi, M.D.\n1. University Hospital, Zurich, Switzerland: William Steinbrunn, M.D.\n3. University Hospital, Basel, Switzerland: Matthias Pfisterer, M.D.\n4. V.A. Medical Center, Long Beach and Cleveland Clinic Foundation: Robert Detrano, M.D., Ph.D.\n\nDonor: David W. Aha (aha '@' ics.uci.edu) (714) 856-8779","pos":10,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"3dd50f","input":"#### Identify Data Type","pos":14,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"50f5bb","input":"#### Feature selection","pos":97,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"542bbf","input":"###### Frequency","pos":47,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"55f283","input":"#### Visualization","pos":19,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"58b79e","input":"#### Contents","pos":9,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"5e8172","input":"#### Label encoding for categorical data","pos":82,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"612bfb","input":"##### Categoric","pos":33,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"6bea65","input":"15 miss classifications in the model with training data and 29 with testing data, Accuracy of the model: 90% with training data and 80% with testing data","pos":95,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"7c20b7","input":"### Problem Description <a class=\"anchor\" id=\"pd\"></a>","pos":4,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"7df06d","input":"#### PCA","pos":98,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"8142f8","input":"##### Numeric","pos":21,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"84c660","input":"## Contents\n\n1. [Problem description](#pd)\n1. [Upload data](#ud)\n1. [Data description](#dd)\n1. [Data exploration and preprocessing](#de)\n    1. Identify the data types\n    1. Identify and treat \"NaN\" values\n    1. Visualization:\n        1. Numeric:\n            1. Correlation\n            1. Distribution\n            1. Histograms\n            1. Scatterplot\n        1. Categoric:\n            1. Frequency\n    1. Label encoding for categorical data\n    1. Data normalization\n    1. Feature Selection\n    1. Dimensionality reduction\n        1. PCA\n        1. LDA\n1. Modeling (For each one, theoretical background + model)\n    1. KNN\n    1. Bayesian methods\n    1. Logistic regression\n    1. Decission trees\n    1. Random Forest\n    1. SVM\n1. Test and validation\n1. Conclusions (Summary)","pos":3,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"871577","input":"#### Linear Discriminant Analysis (LDA)","pos":91,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"89d138","input":"### Upload Data <a class=\"anchor\" id=\"ud\"></a>","pos":6,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"89ed97","input":"Conclusion: Although the proportion in Men is almost the double than in women, making an analysis if the proportion of women and men having disease is different, the P value accepted rejected the null hypothesis (<0.05) therefore the proportion is different. Therefore, although the proportion of women in the study was less, they showed more probability of having a disease.","pos":60,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"8a7d81","input":"Conclusions\n\nNot needed another treament for the features\n","pos":76,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"8ad7cf","input":"#### Data normalization","pos":85,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"8ef1fd","input":"#### Splitting Data","pos":89,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"9dbb2a","input":"### Data Exploration <a class=\"anchor\" id=\"de\"></a>","pos":13,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"ae2986","input":"<center>\n<h4>\n    Heart disease binary classification from clinical data\n    </h4> \n<img src=\"heartDesease.jpg\"  style=\"max-width:30%\">\n</center>","pos":2,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"b6caf7","input":"##### Target","pos":46,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"c31094","input":"Conclusion: In order to find if the categorical variables are independent a chi.squared test was done, as well as an asociation analysis. Therefore, it was concluded that because the asociation was less than the 28% it can be assumed that this variables are independent and are important to be used the way they are in the prediction models.","pos":68,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"c6255e","input":"###### Frequency","pos":34,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"c79965","input":"#### Elliminating missing variables in \"Thal\"","pos":77,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"c8eea5","input":"Some algorithms in machine learning are more sensitive to the scale of data than others since the distance between the data points is very important.\n\nIn order to avoid this problem, a common scale (between 0 and 1) is often used which keeps the distributions of variables the same. This is often referred to as min-max scaling. The formula is shown below\n$$z_{i}= \\frac{x_{i}-min(x)}{max(x)-min(x)}$$\n\nWith $z_{i}$ as the new entry for each $x_{i}$ in the feature analyzed","pos":86,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"c9cbf1","input":"There are not NaN values in the dataset","pos":18,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"d7ce89","input":"According to the World Health Organization, cardiovascular diseases (CVDs) are the **number 1** cause of death globally, around **17.9 million** people die each year, **31%** of the deaths worldwide. More than **75%** of the cases occur in low and middle income countries and **85%** are due to heart attacks and strokes. CVDs are a group of disorders of the heart and blood vessels and include coronary heart disease, cerebrovascular disease, rheumatic heart disease and other conditions.<br>\n\nIndividuals at risk of CVD may demonstrate raised blood pressure, glucose, and lipids as well as overweight and obesity. Millions of people worldwide struggle to control the risk factors that lead to cardiovascular disease, many others remain unaware that they are at high risk. Many heart attacks and strokes can be prevented by controlling major risk factors through lifestyle interventions and drug treatment where necessary.<br>\n\nThe risk factors for CVD include behavioral factors, such as tobacco use, an unhealthy diet, harmful use of alcohol and inadequate physical activity, and physiological factors, including high blood pressure (hypertension), high blood cholesterol and high blood sugar or glucose which are linked to underlying social determinants and drivers, such as ageing, income and urbanization.<br>\n\n*Identifying those at highest risk of CVDs and ensuring they receive appropriate treatment can prevent premature deaths. One way is to perform analyses (quantitative) to predict or classify whether the population are prone to CVDs according to significantly health features and act on them in advance*","pos":5,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"f68339","input":"###### Scatterplot","pos":27,"state":"done","type":"cell"}
{"cell_type":"markdown","id":"fdc5f1","input":"#### Summary","pos":11,"state":"done","type":"cell"}
{"id":0,"time":1588109601240,"type":"user"}
{"last_load":1588109602366,"type":"file"}